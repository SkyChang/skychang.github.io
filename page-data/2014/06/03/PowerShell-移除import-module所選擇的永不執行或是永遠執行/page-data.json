{"componentChunkName":"component---src-templates-page-js","path":"/2014/06/03/PowerShell-移除import-module所選擇的永不執行或是永遠執行/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"PowerShell -  移除import-module所選擇的永不執行或是永遠執行","date":"03 June 2014","author":"Sky Chang","excerpt":null,"tags":["PowerShell"],"coverImage":null},"id":"f7b232cd-70a1-5735-8079-09960bdf74a3","html":"<p>這篇應該是Azure File的番外篇…但其實和Azure File完全沒關係XDD…這篇主要是在寫Azure File的時候，發現使用PowerShell的import-module指令時，小弟我選擇了永遠允許，但當時我卻忘記截圖…Orz…所以發揮追根究柢的精神，就去查了一下，怎要把永遠允許移除掉… (結果造成Azure File的文章還沒寫好…= =… )</p>\n<p>當我們使用import-moudle的時候，可能會出現以下的訊息。</p>\n<p>[V] Never run  [D] Do not run  [R] Run once  [A] Always run  [?] Help (default is \"D\"):</p>\n<p>中文版是這樣。</p>\n<p>C:\\AzureStorageFile\\Microsoft.WindowsAzure.Commands.Storage.File.types.ps1xml 檔案是由 CN=Mi\nOU=MOPR, O=Microsoft Corporation, L=Redmond, S=Washington, C=US\n所發行，在您的系統上並不受信任。只可執行來自受信任的發行者的指令碼。\n[V] 永不執行(V)  [D] 不要執行(D)  [R] 執行一次(R)  [A] 永遠執行(A)  [?] 說明 (預設值為 \"D\"):</p>\n<p>而當時，小弟就隨手的輸入了A…也就是變成了永遠允許。</p>\n<p>那現在該怎要移除呢??，其實PowerShell會建立一個憑證，所以我們只要把那個憑證移除就可以了。</p>\n<p>首先，我們輸入執行mmc</p>\n<p><a href=\"http://lh6.ggpht.com/-fRl7R_xW1Hs/U41hs1_hEAI/AAAAAAAAI6w/wFxo_ZpLjeI/s1600-h/image%25255B3%25255D.png\"><img src=\"http://lh4.ggpht.com/-x-NvQ6fGmgk/U41htu8IGKI/AAAAAAAAI64/dS4maPi6pT0/image_thumb%25255B1%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>預設下，mmc裡面是不會顯示憑證資訊的，所以我們要把憑證資訊顯示出來。</p>\n<p><a href=\"http://lh4.ggpht.com/-gj8v2IYelrU/U41huRcZQsI/AAAAAAAAI7A/Feqkis8oU6g/s1600-h/image%25255B8%25255D.png\"><img src=\"http://lh3.ggpht.com/-oY_M0e-ZNRQ/U41hvHgRxoI/AAAAAAAAI7I/qS7TWvPfGXM/image_thumb%25255B4%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這邊選擇憑證，然後按下新增(被跳出來的視窗擋住了)，然後再選擇我的使用者帳號。</p>\n<p><a href=\"http://lh4.ggpht.com/-Df0LlUa0KSw/U41hwHt64sI/AAAAAAAAI7Q/37a9tFfbgzQ/s1600-h/image%25255B14%25255D.png\"><img src=\"http://lh5.ggpht.com/-mhWyeE3Gqgs/U41hw6wYRrI/AAAAAAAAI7Y/chHDFRRzyzE/image_thumb%25255B8%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>我們就可以從受信任的發行者裡面找到這筆憑證，基本上移除就可以了。</p>\n<p><a href=\"http://lh4.ggpht.com/-7l8ncWgP_Gs/U41hxr9c36I/AAAAAAAAI7g/drel7KRasJg/s1600-h/image%25255B19%25255D.png\"><img src=\"http://lh5.ggpht.com/-ibypm7D6Yu4/U41hyeGChPI/AAAAAAAAI7o/cZ-yVY0eBW0/image_thumb%25255B11%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這是這個憑證的詳細資料。</p>\n<p><a href=\"http://lh4.ggpht.com/-hJIGRwydlS0/U41hy-nH45I/AAAAAAAAI7w/QOxtOahmgyo/s1600-h/image%25255B24%25255D.png\"><img src=\"http://lh5.ggpht.com/-AY9aOpfYRGQ/U41hzkKNHnI/AAAAAAAAI74/Rh8vKPL6dvs/image_thumb%25255B14%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>移除掉後，就可以了…</p>\n<p>那如果不小心按到永不執行呢??那會在沒有信任的憑證裡面，一樣移除就可以了喔!~</p>\n<p><a href=\"http://lh4.ggpht.com/-jqIhiXYSR1E/U41h0Mvmp2I/AAAAAAAAI8A/a3e9toBzKTQ/s1600-h/image%25255B29%25255D.png\"><img src=\"http://lh3.ggpht.com/-OcSX3WWJcP8/U41h02GCaCI/AAAAAAAAI8I/C1ExFqe4rEI/image_thumb%25255B17%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>就這樣簡單… ( 但找了好久… )</p>\n<h4>參考資料</h4>\n<ul>\n<li><a href=\"http://superuser.com/questions/433662/allow-powershell-script-to-run-after-marking-it-with-never-run\" title=\"http://superuser.com/questions/433662/allow-powershell-script-to-run-after-marking-it-with-never-run\">http://superuser.com/questions/433662/allow-powershell-script-to-run-after-marking-it-with-never-run</a></li>\n</ul>","excerpt":"這篇應該是Azure File的番外篇…但其實和Azure File完全沒關係XDD…這篇主要是在寫Azure File的時候，發現使用PowerShell的import-module指令時，小弟我選擇了永遠允許，但當時我卻忘記截圖…Orz…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"ASP.NET MVC - ASP.NET MVC vNext ( MVC 6 ) KVM初體驗","tags":["ASP.NET MVC","Git","KVM"]},"fields":{"slug":"/2014/05/22/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-KVM初體驗/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-KVM初體驗.md"},"previous":{"frontmatter":{"path":null,"title":"Azure -  Azure File","tags":["Azure"]},"fields":{"slug":"/2014/06/04/Azure-Azure-File/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Azure-Azure-File.md"}}}}