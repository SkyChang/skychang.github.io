{"componentChunkName":"component---src-templates-page-js","path":"/2014/06/05/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-初體驗/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"ASP.NET MVC - ASP.NET MVC vNext ( MVC 6 ) 初體驗","date":"05 June 2014","author":"Sky Chang","excerpt":null,"tags":["ASP.NET MVC","Visual Studio"],"coverImage":null},"id":"dd3dcaa1-9827-5a52-bc95-d3001e40b89b","html":"<p><font color=\"#9bbb59\">6/10 更新 加上一些新的解釋</font></p>\n<p>繼上篇之後，這次我們實際來體驗看看MVC 6，這篇原文出處於<a href=\"http://www.asp.net/vnext/overview/aspnet-vnext/getting-started-with-aspnet-vnext-and-visual-studio\">這裡</a>，但不是完全翻譯，小弟邊實作，邊用自己的話加上註解。</p>\n<p><font color=\"#ff0000\">最後，還是要警告，目前版本千萬不要拿來用於正式環境…</font></p>\n<h3>MVC 6預計的功能</h3>\n<h3><font color=\"#ff0000\"></font></h3>\n<p><strong>Cloud-Optimized</strong></p>\n<p>提供雲端優化版本，用來處理雲上的Session、Cache等等之相關問題，以下是官網提供的差異表…</p>\n<p><img src=\"http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-00-63-56-metablogapi/4087.vnextfeaturechart_5F00_thumb_5F00_580533E2.png\" alt=\"vnextfeaturechart\"></p>\n<p><strong>Side by side support</strong></p>\n<p>並列支援，可以輕易的切換雲端版本、或是本地版本，並且獨立升級和佈署。</p>\n<p><strong>Enhanced developer experience</strong></p>\n<p>Visual Studio “14” 提供了不用編譯，只要存檔後刷新瀏覽器，就可以直接看到結果!!，並且提供了新的專案檔，來讓使用者用記事本，或是在雲上直接編輯。</p>\n<p><strong>A single programming model for building Web sites and services</strong></p>\n<p>MVC和WEB API將合併成一個Model</p>\n<p><strong>Modular Stack</strong></p>\n<p>透過NuGet，可以很輕易地選擇自己要的功能，而不用像以前一樣，要一次下載一堆東西。</p>\n<p><strong>Dependency Injection</strong></p>\n<p>依賴注入，整個MVC專案，更加地強化依賴注入。</p>\n<p><strong>Configuration</strong></p>\n<p>全新的設定檔，透過API更可以方便地去控制。</p>\n<p><strong>Open Source</strong></p>\n<p>MVC專案整個Open Source <a href=\"https://github.com/aspnet\">https://github.com/aspnet</a></p>\n<p><strong>Cross-platform support</strong></p>\n<p>跨平台支援，官方正式與momo合作，並且強化各種平台上運行</p>\n<h4>初體驗</h4>\n<p>首先，我們一樣選擇Web；但這次我們要從空的Web Application開始…</p>\n<p><a href=\"http://lh4.ggpht.com/-fKuFAiBcjK0/U5CTGhZ9VVI/AAAAAAAAJCw/DB-a-fe-BsQ/s1600-h/image%25255B3%25255D.png\"><img src=\"http://lh3.ggpht.com/-oBRmdcSXbn4/U5CTIBoKJ5I/AAAAAAAAJC4/21aHob_w_uo/image_thumb%25255B1%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>完成後…就真的很空…</p>\n<p><a href=\"http://lh5.ggpht.com/-hMVr7HlZ2Nk/U5CTJKd8A4I/AAAAAAAAJC8/qWLDWtqePwI/s1600-h/image%25255B7%25255D.png\"><img src=\"http://lh4.ggpht.com/-jMxIjHsHrF0/U5CTKT-2N3I/AAAAAAAAJDI/HzY2Lw_68PQ/image_thumb%25255B3%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，我們一個一個看…</p>\n<h4>myproject.kproj</h4>\n<p>這是新的專案檔，用來取代舊的專案檔，裡面紀錄的是目前這個MVC有用到的檔案，基本上，ASP.NET MVC在Runtime的時候，是不會用到這個檔案的，主要用途還是用在CI上，也就是說，是給Visual Studio專用的；而根據官方所敘述，目前這個專案下的所有檔案，都會被自動的加入到這個專案檔之下( 目前也沒辦法和vs 2013一樣，可以將檔案移除到專案外 )，而官方說，未來這個專案檔將不會再去紀錄這個目錄下的檔案，所以這個檔案未來會怎樣，還是要看後續版本。</p>\n<p>另外，kproj目前也很有意思，如果我們把sln、sln.ide、kproj這些檔案砍掉，只留下project.json這個檔案，我們還是可以用project.json開啟專案，而且sln、sln.ide、kproj會自動恢復…；其實這個用意就如前面所敘述的，未來MS希望能支援多個平台的開發，所以不會再綁定kproj這個專案檔，而只要有project.json，就可以進行專案的開發。</p>\n<h4>config.json</h4>\n<p>取代Web.Config用的檔案，根據官方所敘述，只要你想，你可以使用ini、xml、json當作副檔名來撰寫設定用的檔案；在官方預設提供的範本，我們可以看到原本寫在web.config的連線在串，變成如下圖了。</p>\n<p><a href=\"http://lh5.ggpht.com/-DFUMqILFe_U/U5ctuxDuK1I/AAAAAAAAJJY/NsduKkzTu9M/s1600-h/image%25255B4%25255D.png\"><img src=\"http://lh6.ggpht.com/-Ht3FkI2mi-0/U5ctvgyIqCI/AAAAAAAAJJg/K_OZ-qEmm1Y/image_thumb%25255B1%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>處此之外後面會介紹到的Startup.cs這個檔案，也要去做一些設定；我們可以從下圖看到，設定config的code。</p>\n<p><a href=\"http://lh3.ggpht.com/-i_jtnwMfOLY/U5ctwFlf3fI/AAAAAAAAJJo/R3qb4VddokU/s1600-h/image%25255B8%25255D.png\"><img src=\"http://lh6.ggpht.com/-WLckKqapaH0/U5ctxR4NyrI/AAAAAAAAJJs/uCBVuJ97ljI/image_thumb%25255B3%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>官方也有提到，如果要取得config裡面的資料，例如connectionString，也可以用這種方式取得。</p>\n<p><a href=\"http://lh4.ggpht.com/-6Hw6KOxxjXI/U5ctxwrN2aI/AAAAAAAAJJ0/5D3B4Kpqpjc/s1600-h/image%25255B12%25255D.png\"><img src=\"http://lh5.ggpht.com/-qyuvs5WDI74/U5ctyttjJ-I/AAAAAAAAJKA/YOpdsDQIOvw/image_thumb%25255B5%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<h4>project.json</h4>\n<p>它包含了相依性的列表，組件輸出的列表，還有命令的列表，這也是全新的檔案，而裡面的dependencies主要是負責NuGet package或其他項目。而現在空的vNext Web專案的唯一依賴是Helios ( 太陽神…聽起來就很威的感覺XDDD ) 這個NuGet包，他可以使應用程序在IIS中運行。( 未來還會不會出現雅典娜、宙斯、波斯頓、黑帝斯之類的阿= =|| )；而當是NuGet的依賴關係時，Visual Studio會非同步異步的恢復任何遺失的項目，並且載入；而我們仔細看右邊，會發現現在有階層的關係了，這也會讓我們對於依賴的項目，更加得清楚，並且好管理。</p>\n<p><a href=\"http://lh6.ggpht.com/-SuC4094qUuM/U5CTLUS4EGI/AAAAAAAAJDQ/UGzLJKmP85o/s1600-h/image%25255B12%25255D.png\"><img src=\"http://lh3.ggpht.com/-khnjaYWbRhM/U5CTMvEcQVI/AAAAAAAAJDY/net6bYdJ0yc/image_thumb%25255B6%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>另外，我們可以透過更改設定，並將目標框架設置為.NET Core Framework 4.5；這時候，可以看到右邊也會迅速地去做切換。另外，.Net Core Framework 為雲端優化版本。</p>\n<p><a href=\"http://lh6.ggpht.com/-I3cwYt994ew/U5CTNtf3MhI/AAAAAAAAJDc/mdolLWyOMF8/s1600-h/image%25255B17%25255D.png\"><img src=\"http://lh4.ggpht.com/-jND0Ie6_2Lc/U5CTOzSYuZI/AAAAAAAAJDo/Wb8rkh-zL0I/image_thumb%25255B9%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>此外，project.json還可以包含命令，例如下圖，我們可以將ASP.NET slef host，而不需要iis；此時，我們就可以用commands來指定port等等…</p>\n<p><a href=\"http://lh3.ggpht.com/-ZYRy9vjLXUo/U5CTP0tDXAI/AAAAAAAAJDw/Jyn1cpzXp00/s1600-h/image%25255B22%25255D.png\"><img src=\"http://lh4.ggpht.com/-1UmWZp8Ycw4/U5CTQvI9C0I/AAAAAAAAJD4/iEqhtc9XRnk/image_thumb%25255B12%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>以前我們加入NuGet是可以用滑鼠點的，現階段應該是因為CTP的關係，所以只能用IntelliSense來選NuGet套件…但是IntelliSense目前的範圍只有預設的NuGet來源、Package目錄、如果打angularjs，基本上目前是找不到的… ( 但如果全部打正確，還是可以下載 )，所以目前還是要自己去查套件名稱…</p>\n<p>而套件名稱打完後，冒號後面可以選擇版本， 可以指地明確的版本（例如，\"0.1-α – build - 1268”），或是用一個空字串（例如，“”）來表示最新，也可以使用通用符來指定（例如，“0.1-α-build-*”）；但目前為止，只有如下圖的版號，才能正常運作。</p>\n<p><a href=\"http://lh3.ggpht.com/--G3iU1Pm2Xc/U5CTRlY84_I/AAAAAAAAJEA/6pHjONj_Fxo/s1600-h/image%25255B35%25255D.png\"><img src=\"http://lh6.ggpht.com/-Y0EwIsXbICU/U5CTSj0zX0I/AAAAAAAAJEI/r269D5RPEt4/image_thumb%25255B19%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>而基本上你刪除project.json依賴關係後，Visual Studio不會刪除Package目錄下的東西，但也還好，畢竟這個目錄下不會包含在source controller裡面。</p>\n<h4>Startup.cs</h4>\n<p>其實從MVC 5開始，就已經出現了這個Class了，而MVC 6正式啟用這個類別，而原本的Global.asax也算是進入歷史了吧…</p>\n<p>默認情況下，ASP.NET MVC啟動後，會先找到Startup這個Class，而這個Class預設會有一個Configure這個方法，而這個方法會傳入IBuilder這個型別的東東；而這個方法的用途，就是讓我們可以去控制HTTP pipeline。</p>\n<p><a href=\"http://lh4.ggpht.com/-bNGHJCunII8/U5CTTt2VGvI/AAAAAAAAJEQ/xxq8VDrfx7o/s1600-h/image%25255B27%25255D.png\"><img src=\"http://lh5.ggpht.com/-PnryPw1KuaU/U5CTUhW687I/AAAAAAAAJEY/feaAHteFQaY/image_thumb%25255B15%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這邊我們使用AddMvc來注入，並且使用UseMvc方法來設定MVC的預設值， 例如路由。</p>\n<p><a href=\"http://lh3.ggpht.com/-FC5o_3fGKro/U5CTVaEh31I/AAAAAAAAJEg/JJZ58gu9AVg/s1600-h/image%25255B39%25255D.png\"><img src=\"http://lh5.ggpht.com/-x0oP3VCfOzI/U5CTWqBqOFI/AAAAAAAAJEo/jb5cNad_s4E/image_thumb%25255B21%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，我們要來新增Controller 和 View</p>\n<h4>新增controller和view</h4>\n<p>首先，我們要先建立下面兩個目錄，基本上，還好這個規則沒變XDD</p>\n<p><a href=\"http://lh3.ggpht.com/-vmZlsu4eba8/U5CTXTu1iXI/AAAAAAAAJEw/gupaflq7C60/s1600-h/image%25255B43%25255D.png\"><img src=\"http://lh5.ggpht.com/-lma32dyRwzk/U5CTYt2u-mI/AAAAAAAAJE4/In-kW2jYmt4/image_thumb%25255B23%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>然後就和以前差不多，只是現在IDE有些功能還沒那麼簡潔迅速就是了…要多一點步驟來建立；我們這邊加上Controller Class；基本上這和以前MVC一樣，小弟就不深入多說了。</p>\n<p><a href=\"http://lh3.ggpht.com/-AqWLDfxN6tY/U5CTZuxcLWI/AAAAAAAAJFA/JykQzwQQbTE/s1600-h/image%25255B48%25255D.png\"><img src=\"http://lh6.ggpht.com/-LAa6vYS-YEA/U5CTavlHlAI/AAAAAAAAJFI/Wgks5CgLWKA/image_thumb%25255B26%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>打開Controller可以發現，原本是ActionResult，現在變成IActionResult了，變成interface了，這是件非常好的事情阿!!!</p>\n<p><a href=\"http://lh6.ggpht.com/-1_jM3_DRWLg/U5CTb786SoI/AAAAAAAAJFQ/m5E6MHDIInA/s1600-h/image%25255B54%25255D.png\"><img src=\"http://lh3.ggpht.com/-pc7bFR_T1Q0/U5CTchgAiBI/AAAAAAAAJFY/SUZJvfhTxNQ/image_thumb%25255B30%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>增加View…</p>\n<p><a href=\"http://lh6.ggpht.com/-lOBGKfe9Ooc/U5CTdgz3HLI/AAAAAAAAJFg/ri-y-4gXaCw/s1600-h/image%25255B59%25255D.png\"><img src=\"http://lh5.ggpht.com/-FpA6S6LqaTc/U5CTep7-nNI/AAAAAAAAJFo/qge4BCx2XhY/image_thumb%25255B33%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>別忘了，View要放在和Controller同名的目錄下喔!~</p>\n<p><a href=\"http://lh4.ggpht.com/-EFnZ_rI1XKY/U5CTfnZJMPI/AAAAAAAAJFw/mPtxDZP-08U/s1600-h/image%25255B73%25255D.png\"><img src=\"http://lh4.ggpht.com/--wE4zcS6jdA/U5CTgeGancI/AAAAAAAAJF4/WtVWK-9LjHQ/image_thumb%25255B41%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這邊，我們直接輸出時間。</p>\n<p><a href=\"http://lh6.ggpht.com/-mmaEKaweEeQ/U5CTiKLBvYI/AAAAAAAAJGA/GtF_Zt5dZQY/s1600-h/image%25255B64%25255D.png\"><img src=\"http://lh4.ggpht.com/-8iBfSFotd1M/U5CTjLUbWHI/AAAAAAAAJGI/vuhZ1uUPxCk/image_thumb%25255B36%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>然後run起來後，就可以看到如下圖了；因為Server為UTC時間…所以台灣時間應該要加上8小時喔~~</p>\n<p><a href=\"http://lh5.ggpht.com/-R-NtfRvIFi4/U5CTkFYw1dI/AAAAAAAAJGQ/9iGmVKcLSec/s1600-h/image%25255B78%25255D.png\"><img src=\"http://lh6.ggpht.com/-adItRhqaNMI/U5CTlCMZofI/AAAAAAAAJGY/EoYvRvGZsLU/image_thumb%25255B44%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>以上是初步的初體驗，後面還有更多東西喔!!我們準備進入下一篇~~</p>\n<h4>後記</h4>\n<p>順便補上錯誤的新畫面XDDD</p>\n<p><a href=\"http://lh3.ggpht.com/-dpBFduc7m90/U5CTmI3mpKI/AAAAAAAAJGg/3QYfxgOvJqY/s1600-h/image%25255B69%25255D.png\"><img src=\"http://lh5.ggpht.com/-0CqOW6Ut8kc/U5CTnTybzkI/AAAAAAAAJGo/lWjHe4x9JJw/image_thumb%25255B39%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>以後不是白底黃字了~~</p>\n<h4>參考資料</h4>\n<ul>\n<li><a href=\"http://www.asp.net/vnext/overview/aspnet-vnext/getting-started-with-aspnet-vnext-and-visual-studio\" title=\"http://www.asp.net/vnext/overview/aspnet-vnext/getting-started-with-aspnet-vnext-and-visual-studio\">http://www.asp.net/vnext/overview/aspnet-vnext/getting-started-with-aspnet-vnext-and-visual-studio</a>  <li><a href=\"http://blogs.msdn.com/b/webdev/archive/2014/06/03/asp-net-vnext-in-visual-studio-14-ctp.aspx\" title=\"http://blogs.msdn.com/b/webdev/archive/2014/06/03/asp-net-vnext-in-visual-studio-14-ctp.aspx\">http://blogs.msdn.com/b/webdev/archive/2014/06/03/asp-net-vnext-in-visual-studio-14-ctp.aspx</a></li>\n</ul>","excerpt":"6/10 更新 加上一些新的解釋 繼上篇之後，這次我們實際來體驗看看MVC 6，這篇原文出處於這裡，但不是完全翻譯，小弟邊實作，邊用自己的話加上註解。 最後，還是要警告，目前版本千萬不要拿來用於正式環境… MVC 6預計的功能  Cloud-Optimized…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"Visual Studio - Visual Studio 14 CTP 1 隨便玩","tags":["ASP.NET MVC","Visual Studio"]},"fields":{"slug":"/2014/06/04/Visual-Studio-Visual-Studio-14-CTP-1-隨便玩/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Visual-Studio-Visual-Studio-14-CTP-1-隨便玩.md"},"previous":{"frontmatter":{"path":null,"title":"ASP.NET MVC - ASP.NET MVC vNext ( MVC 6 ) 參考其他專案","tags":["ASP.NET MVC","Visual Studio"]},"fields":{"slug":"/2014/06/10/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-參考其他專案/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-參考其他專案.md"}}}}