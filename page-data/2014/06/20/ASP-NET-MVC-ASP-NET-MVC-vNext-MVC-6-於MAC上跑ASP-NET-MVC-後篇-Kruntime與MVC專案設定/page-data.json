{"componentChunkName":"component---src-templates-page-js","path":"/2014/06/20/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-於MAC上跑ASP-NET-MVC-後篇-Kruntime與MVC專案設定/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"ASP.NET MVC - ASP.NET MVC vNext ( MVC 6 ) 於MAC上跑ASP.NET MVC (後篇) Kruntime與MVC專案設定","date":"20 June 2014","author":"Sky Chang","excerpt":null,"tags":["ASP.NET MVC","KVM","Mac"],"coverImage":null},"id":"3ae5d6d7-e784-5a66-b88a-37125a9d64fa","html":"<p>開始前，還是要提醒大家，目前也還有很多問題，小弟測試下來，真的感受到，要用於正式環境還有一段路要走…</p>\n<p>後篇與前篇相比起來，因該是簡單的多，基本上就是兩件事情，第一件事情是要建立Kruntime和KVM，第二件事情則是要針對OSX上，MVC的設定。</p>\n<h4>建立Kruntime與KVM</h4>\n<p>基本上，要建立Kruntime與KVM只要下以下這個指令就可以了…</p>\n<blockquote>\n<p>curl <a href=\"https://raw.githubusercontent.com/aspnet/Home/master/kvminstall.sh\">https://raw.githubusercontent.com/aspnet/Home/master/kvminstall.sh</a> | sh &#x26;&#x26; source ~/.kre/kvm/kvm.sh &#x26;&#x26; kvm upgrade </p>\n</blockquote>\n<p>這個指令基本上做的事情和在Windows下安裝Kruntime和KVM是同樣的…他會做以下的事情。</p>\n<ul>\n<li>下載kvm.sh並且儲存在~/.kre/kvm/kvm.sh   <li>使用<code class=\"language-text\">kvm upgrade下載最新的KRE Package</code> </li>\n</ul>\n<p><code class=\"language-text\">完成之後，我們就可以使用kvm list來查看裝了哪些東西…</code></p>\n<p><code class=\"language-text\">[![螢幕快照 2014-06-19 上午1.26.34](http://lh3.ggpht.com/-J_gJuhN91-g/U6HReb-UysI/AAAAAAAAJWQ/qa28kcSdhUo/Image.png?imgmax=800 &quot;螢幕快照 2014-06-19 上午1.26.34&quot;)](http://lh3.ggpht.com/--YVjMN6CHlU/U6HRdkmPezI/AAAAAAAAJWI/hjBYIVOEKaY/s1600-h/Image.png)</code></p>\n<p>基本上，這樣Kruntime環境與KVM就設定完成了。</p>\n<h4>設定MVC</h4>\n<p>設定MVC專案有幾個地方需要設定，一個是NuGet.config，另外一個是project.json，最後Startup.cs也是要加上useMvc；另外建議也把一些不需要的東西砍一砍，基本上留下下面這些就夠了。</p>\n<p>而比較特別的是Nowin.vNext這個相依的專案，這是國外的高手寫的，就是為了解決OSX上的問題；請注意，當初Scott在Demo的時候，也是有加入Nowin，但實際上，Nuget裡面是找不到Nowin的… ( 未來可能會有… ) 所以現在是由網友熱情自己撰寫一個~~</p>\n<p>那大家可能會想，我要去哪找到這個Nowin.vNext這個專案，大家可以到這邊去<a href=\"https://github.com/davidfowl/HelloWorldVNext\">下載</a>。</p>\n<p><a href=\"http://lh5.ggpht.com/-n6ENkRe1-MM/U6HRfbjaNYI/AAAAAAAAJWY/MS12vsL0Enc/s1600-h/Image.png\"><img src=\"http://lh6.ggpht.com/-nGwEtY505V0/U6HRgVm78XI/AAAAAAAAJWg/JxT2wjnV6mY/Image.png?imgmax=800\" alt=\"螢幕快照 2014-06-19 上午1.28.55\" title=\"螢幕快照 2014-06-19 上午1.28.55\"></a></p>\n<p>NuGet.Config的設定一樣，要加上ASP.NET vNext現在的dev版本下載位置，平常的NuGet只能取得比較穩定的版本，但畢竟現在版本衝得太快(因為在開發中)，所以很容易版本不同匹配不起來，所以這邊還是建議使用最新的dev版本。</p>\n<p><a href=\"http://lh6.ggpht.com/--0W18_lF6QY/U6HRgxiZnaI/AAAAAAAAJWo/a0xt40T-1ys/s1600-h/Image.png\"><img src=\"http://lh3.ggpht.com/-s2BnS37mQRg/U6HRh_oKpDI/AAAAAAAAJWw/qLfZYrKBXKo/Image.png?imgmax=800\" alt=\"螢幕快照 2014-06-19 上午1.30.18\" title=\"螢幕快照 2014-06-19 上午1.30.18\"></a></p>\n<p>以下是NuGet.Config的code</p>\n<pre class=\"brush: xml;\">&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;configuration&gt;\n  &lt;packageSources&gt;\n    &lt;add key=\"AspNetVNext\" value=\"https://www.myget.org/F/aspnetvnext/\" /&gt;\n    &lt;add key=\"NuGet.org\" value=\"https://nuget.org/api/v2/\" /&gt;\n  &lt;/packageSources&gt;\n  &lt;packageSourceCredentials&gt;\n    &lt;AspNetVNext&gt;\n      &lt;add key=\"Username\" value=\"aspnetreadonly\" /&gt;\n      &lt;add key=\"ClearTextPassword\" value=\"4d8a2d9c-7b80-4162-9978-47e918c9658c\" /&gt;\n    &lt;/AspNetVNext&gt;\n  &lt;/packageSourceCredentials&gt;\n&lt;/configuration&gt;\n</pre>\n<p>另外，project.json的設定如下，要改command和加入Nowin.vNext這個相依，所以目錄下，一定要有Nowin.vNext這個專案。</p>\n<p><a href=\"http://lh3.ggpht.com/-QSIyiZ8kLw8/U6HRivn3jsI/AAAAAAAAJW4/bUDARHRuckU/s1600-h/Image.png\"><img src=\"http://lh3.ggpht.com/-0epqv6-3r0g/U6HRja6EmXI/AAAAAAAAJXA/G5wmX42VCX8/Image.png?imgmax=800\" alt=\"螢幕快照 2014-06-19 上午1.30.23\" title=\"螢幕快照 2014-06-19 上午1.30.23\"></a></p>\n<p>以下是project.json的code</p>\n<pre class=\"brush: js;\">{\n    \"dependencies\": {\n        \"Microsoft.AspNet.Mvc\": \"0.1-alpha-*\",\n        \"Nowin.vNext\": \"\"\n    },\n    \"commands\": {\n        \"web\": \"Microsoft.AspNet.Hosting --server Nowin.vNext\"\n    }\n}\n</pre>\n<p>基本上Startup.cs沒甚麼改變，但現在大家應該還是不習慣vNext，所以也在這邊貼出來，提醒大家一下。</p>\n<p><a href=\"http://lh6.ggpht.com/-YncmGFPjdBE/U6HRkh8-vgI/AAAAAAAAJXI/mFnvsaVxxy8/s1600-h/Image.png\"><img src=\"http://lh4.ggpht.com/-HBo7oaBwZFg/U6HRlYtheuI/AAAAAAAAJXQ/aXJ1Z444JPg/Image.png?imgmax=800\" alt=\"螢幕快照 2014-06-19 上午1.31.51\" title=\"螢幕快照 2014-06-19 上午1.31.51\"></a></p>\n<p>以下是Startup.cs的Code。</p>\n<pre class=\"brush: csharp;\">using System;\nusing Microsoft.AspNet.Builder;\nusing Microsoft.Framework.DependencyInjection;\n\nnamespace WebApplication1\n{\n    public class Startup\n    {\n        public void Configure(IBuilder app)\n        {\n            // For more information on how to configure your application, visit http://go.microsoft.com/fwlink/?LinkID=398940\n            app.UseServices(services =&gt;\n            {\n                services.AddMvc();\n            });\n\n             app.Use(async (context, next) =&gt; \n             {\n                Console.WriteLine(context.Request.Path);\n\n                try\n                {\n                    await next();\n                }\n                catch(Exception ex)\n                {\n                    Console.WriteLine(ex);\n                }\n            });\n\n            app.UseMvc();\n        }\n    }\n}\n</pre>\n<p>然後在run之前，要先用kpm restore，在下指令之前，也別忘記，進入到專案的目錄下。</p>\n<p>( 是專案，不是方案喔 )</p>\n<p><a href=\"http://lh5.ggpht.com/-0u-lrRKsen4/U6HRl0_cxdI/AAAAAAAAJXY/SpgyBHD3r4g/s1600-h/Image.png\"><img src=\"http://lh5.ggpht.com/-eDB7u3gaLjg/U6HRmpaxmpI/AAAAAAAAJXg/UW5vqK4Pdcs/Image.png?imgmax=800\" alt=\"螢幕快照 2014-06-19 上午1.44.51\" title=\"螢幕快照 2014-06-19 上午1.44.51\"></a></p>\n<p>最後，下k web這個指令，就可以run起來；而難得有OSX表現的機會，我們這次就讓safari來表現一下吧XDD</p>\n<p>( 預設的port是8080 )</p>\n<p><a href=\"http://lh3.ggpht.com/-Z83J3ydYLHo/U6HRn6mGvwI/AAAAAAAAJXo/FLGgdejoAS8/s1600-h/Image.png\"><img src=\"http://lh6.ggpht.com/-iWz7WLsjWGw/U6HRo0RFSOI/AAAAAAAAJXw/PVPuQ6n8E7g/Image.png?imgmax=800\" alt=\"螢幕快照 2014-06-19 上午1.47.46\" title=\"螢幕快照 2014-06-19 上午1.47.46\"></a></p>\n<p>這樣就完成嚕，當然現階段這部分也還在開發，相信明年的這個時候，會更加的方便!!</p>\n<h4>參考資料</h4>\n<ul>\n<li><a href=\"http://graemechristie.github.io/graemechristie/blog/2014/05/26/asp-dot-net-vnext-on-osx-and-linux/\" title=\"http://graemechristie.github.io/graemechristie/blog/2014/05/26/asp-dot-net-vnext-on-osx-and-linux/\">http://graemechristie.github.io/graemechristie/blog/2014/05/26/asp-dot-net-vnext-on-osx-and-linux/</a><li><a href=\"https://github.com/davidfowl/HelloWorldVNext\" title=\"https://github.com/davidfowl/HelloWorldVNext\">https://github.com/davidfowl/HelloWorldVNext</a><li><a href=\"https://github.com/Alxandr/Nowin.vNext\" title=\"https://github.com/Alxandr/Nowin.vNext\">https://github.com/Alxandr/Nowin.vNext</a></li>\n</ul>","excerpt":"開始前，還是要提醒大家，目前也還有很多問題，小弟測試下來，真的感受到，要用於正式環境還有一段路要走… 後篇與前篇相比起來，因該是簡單的多，基本上就是兩件事情，第一件事情是要建立Kruntime和KVM，第二件事情則是要針對OSX上，MVC的設定。 建立Kruntime與KVM…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"ASP.NET MVC - ASP.NET MVC vNext ( MVC 6 ) 於MAC上跑ASP.NET MVC (上篇) 安裝Mono","tags":["ASP.NET MVC","Git","KVM","Linux","Mac","mono"]},"fields":{"slug":"/2014/06/20/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-於MAC上跑ASP-NET-MVC-上篇-安裝Mono/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/ASP-NET-MVC-ASP-NET-MVC-vNext-MVC-6-於MAC上跑ASP-NET-MVC-上篇-安裝Mono.md"},"previous":{"frontmatter":{"path":null,"title":"VSO - 使用Azure進行Visual Studio Online的付費","tags":["Azure","TFS","Visual Studio","VSO"]},"fields":{"slug":"/2014/07/25/VSO-使用Azure進行Visual-Studio-Online的付費/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/VSO-使用Azure進行Visual-Studio-Online的付費.md"}}}}