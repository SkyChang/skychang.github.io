{"componentChunkName":"component---src-templates-page-js","path":"/2014/11/02/Visual-Studio-使用Nuspec來自動產生NuGet-Package/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Visual Studio - 使用Nuspec來自動產生NuGet Package","date":"02 November 2014","author":"Sky Chang","excerpt":null,"tags":["NuGet","Visual Studio"],"coverImage":null},"id":"e3cbc7d8-e902-5b69-b982-0bd43b63be03","html":"<p><a href=\"http://blog.sanc.idv.tw/2014/11/visual-studio-nuget-package.html\">前一篇</a>，我們使用MSBuild來達到Build的時候，自動產生NuGet Package，而當我們使用NuGet Package Explorer打開來看的時候，我們會發現Package metadata的資料也順便的幫我們填上了。</p>\n<p><a href=\"http://lh4.ggpht.com/-cdtU-khuYgA/VFXWxemtfjI/AAAAAAAAKO0/wQw2GecGo3E/s1600-h/image%25255B5%25255D.png\"><img src=\"http://lh4.ggpht.com/-N5pjTX2r9Jk/VFXWyYJFnOI/AAAAAAAAKO8/GYQCVy3_gvc/image_thumb%25255B3%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>為什麼NuGet Package會知道填甚麼值呢?，那是因為它會自動抓AssemblyInfo.cs檔案，如下圖。</p>\n<p><a href=\"http://lh3.ggpht.com/-_LRRpkwpKyE/VFXWz_Y-KVI/AAAAAAAAKPE/El2uX08ndzU/s1600-h/image%25255B10%25255D.png\"><img src=\"http://lh3.ggpht.com/-c21dsBMrU70/VFXW0jrjV4I/AAAAAAAAKPI/ebCBCNf0sXM/image_thumb%25255B6%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>其中的對應表如下圖，我們可以改以下的對應表來產生不同內容的Package metadata，但要特別注意，<font color=\"#ff0000\">AssemblyCulture必須保持為空值</font>，不然會NuGet Package的產生，會有問題。</p>\n<p><a href=\"http://lh4.ggpht.com/-IWSQEO7yOQE/VFXW1mPgEQI/AAAAAAAAKPU/JTXBK-Jrbcs/s1600-h/image%25255B15%25255D.png\"><img src=\"http://lh4.ggpht.com/-YevT0ncQWoA/VFXW2rAApZI/AAAAAAAAKPY/OT3DtQH1LrE/image_thumb%25255B9%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>但實際上，AssemblyInfo還是不能涵蓋所有的Package metadata，更理想的狀況還是透過nuspec這個檔案來定義Package metadata；但如果自己要Key nuspec這個檔案也太辛苦了，所以我們可以從nupkg這個檔案，來解壓縮，找到nuspec。</p>\n<p>( nupkg其實就是一個zip檔案，大家可以透過7-zip工具，或是直接把nupkg這個副檔名改成zip，就可以順利解壓縮了… )</p>\n<p><a href=\"http://lh4.ggpht.com/-f9LoxFyFuLM/VFXW3vVIifI/AAAAAAAAKPk/7VI2kVoSzS0/s1600-h/image%25255B19%25255D.png\"><img src=\"http://lh3.ggpht.com/-O6hXkJz47uk/VFXW4foAx9I/AAAAAAAAKPs/089NAVuKs1s/image_thumb%25255B11%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>之後，我們只需要把nuspec拷貝到專案的目錄底下去就可以了，但要特別注意，<font color=\"#ff0000\">nuspec的檔案名稱，必須和專案的名稱相同</font>喔!!</p>\n<p><a href=\"http://lh4.ggpht.com/-VycUs-87RU4/VFXW5rJAmfI/AAAAAAAAKP0/hpO7N4hDotg/s1600-h/image%25255B33%25255D.png\"><img src=\"http://lh6.ggpht.com/-3KG-tfZJxy4/VFXW6OCYbUI/AAAAAAAAKP8/Xvj-b-NBbYo/image_thumb%25255B19%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>完成之後，重build一下，我們就可以發現，這次完全使用nuspec的內容了。</p>\n<p><a href=\"http://lh4.ggpht.com/-ctvSFy-P8Ik/VFXW7LmihgI/AAAAAAAAKQE/v9oKq-UHftQ/s1600-h/image%25255B23%25255D.png\"><img src=\"http://lh3.ggpht.com/-PHfYRZgfNvg/VFXW8Dm1K7I/AAAAAAAAKQM/gflCIAoBjZo/image_thumb%25255B13%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>最後，要特別注意，因為我們希望建置NuGet Package的時候，他自動去抓取packages.config這個檔案，來解析相依的問題，所以別忘記把nuspec裡面的相依給移除掉喔。</p>\n<p><a href=\"http://lh6.ggpht.com/-wGp6KkHcTos/VFXW8ktShMI/AAAAAAAAKQU/8R80qVFMcSs/s1600-h/image%25255B28%25255D.png\"><img src=\"http://lh4.ggpht.com/-k5tk0P9-bNQ/VFXW9pNUNjI/AAAAAAAAKQc/I7vqceS0iek/image_thumb%25255B16%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>也就是這行裡面的內容。</p>\n<pre class=\"brush: xml;\">&lt;dependencies&gt;\n  &lt;dependency id=\"Newtonsoft.Json\" version=\"6.0.6\" /&gt;\n&lt;/dependencies&gt;\n</pre>\n<p>到這邊，就完成嚕!!~</p>\n<p>參考資料</p>\n<ul>\n<li><a href=\"http://ihadthisideaonce.com/2014/02/24/nuget-like-a-pro-the-msbuild-way/\" title=\"http://ihadthisideaonce.com/2014/02/24/nuget-like-a-pro-the-msbuild-way/\">http://ihadthisideaonce.com/2014/02/24/nuget-like-a-pro-the-msbuild-way/</a></li>\n</ul>","excerpt":"前一篇，我們使用MSBuild來達到Build的時候，自動產生NuGet Package，而當我們使用NuGet Package Explorer打開來看的時候，我們會發現Package metadata的資料也順便的幫我們填上了。 image 為什麼NuGet Package…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"Visual Studio - 建置的時候自動產生NuGet Package","tags":["NuGet","Visual Studio"]},"fields":{"slug":"/2014/11/02/Visual-Studio-建置的時候自動產生NuGet-Package/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Visual-Studio-建置的時候自動產生NuGet-Package.md"},"previous":{"frontmatter":{"path":null,"title":"Visual Studio - 自動產生NuGet Package並移除舊版Package","tags":["NuGet","Visual Studio"]},"fields":{"slug":"/2014/11/02/Visual-Studio-自動產生NuGet-Package並移除舊版Package/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Visual-Studio-自動產生NuGet-Package並移除舊版Package.md"}}}}