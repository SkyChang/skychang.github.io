{"componentChunkName":"component---src-templates-page-js","path":"/2012/08/23/Windows-Azure-用存在Azure-Storage現有的VHD重新佈署VM/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Windows Azure -  用存在Azure Storage現有的VHD重新佈署VM","date":"23 August 2012","author":"Sky Chang","excerpt":null,"tags":["Azure"],"coverImage":null},"id":"7339a16b-6377-541c-ac74-6f5482862da0","html":"<p>當在Windows Azure上面建立了一台VM後，其實是會在Storage裡面創建一個VHD的，就算我們不小心刪除了剛剛建立好的VM，或是因為服務額度超過被停用，以至於此VM被移除，等等之類的狀況；乍看之下VM已經消失了，但實際上，我們還是可以利用原有的VHD重新佈署回來 ( 只是Public IP會變得不一樣就是了… )，如下圖，VHD會被存到Storage裡面去。</p>\n<p><a href=\"http://lh4.ggpht.com/-f9pt9ZRS2V8/UDXDOvjgj8I/AAAAAAAAESQ/n9JTeQV28Pg/s1600-h/image%25255B13%25255D.png\"><img src=\"http://lh4.ggpht.com/-i5As9jZFYlQ/UDXDPh5g9zI/AAAAAAAAESY/W98NEvdNrYs/image_thumb%25255B7%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，我們就來看看怎樣利用原有的VHD重新佈署回來。</p>\n<p>首先我們要知道，之前建立的VM，如果被刪除的話，都會出現一個空的Cloud Service，如下圖，原本的study4dns這台VM被移除掉之後，在Cloud Services裡面就會出現一個空的Cloud Service ( 如果沒有刪除VM，就不會看到Cloud Services )，小弟是推測，可能VM的架構也是Run在Cloud Service上。</p>\n<p><a href=\"http://lh5.ggpht.com/-8iP7xwMXcug/UDXDQXZOlQI/AAAAAAAAESc/5TUGzLXTOqM/s1600-h/image%25255B3%25255D.png\"><img src=\"http://lh3.ggpht.com/-qLxGKKdsAus/UDXDRC9RH0I/AAAAAAAAESk/_p9BlwWyvow/image_thumb%25255B1%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，點進去這個Cloud Service之後，我們要把這個Cloud Service給刪除掉；原因很簡單，因為如果沒刪除，網址的部分就會被這個Cloud Service給佔用掉。</p>\n<p><a href=\"http://lh3.ggpht.com/-4czo8ymw-_8/UDXDR5Z2AUI/AAAAAAAAESs/gajIVZihKl8/s1600-h/image%25255B8%25255D.png\"><img src=\"http://lh6.ggpht.com/-6afwQBiHSxM/UDXDS92tubI/AAAAAAAAES0/v6NrlQqTXCk/image_thumb%25255B4%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，就如同以前建立VM的步驟，選擇購物車。</p>\n<p><a href=\"http://lh6.ggpht.com/-ZddYNLYo3UE/UDXDTvXmciI/AAAAAAAAES8/gpYTFQXumnk/s1600-h/image%25255B17%25255D.png\"><img src=\"http://lh4.ggpht.com/-LKrXZGkNtlk/UDXDUlUgoFI/AAAAAAAAETI/cqO8MMOR6zg/image_thumb%25255B9%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這時候，我們就會發現，最底下有我們之前的VHD可以選擇。</p>\n<p><a href=\"http://lh6.ggpht.com/-NIdR2jrcFIY/UDXDVnQO93I/AAAAAAAAETQ/77agyehE2ZU/s1600-h/image%25255B22%25255D.png\"><img src=\"http://lh3.ggpht.com/-UXh6tWnhksU/UDXDWpqvTII/AAAAAAAAETY/KCVNB9s8mAA/image_thumb%25255B12%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這部分就和之前的流程沒兩樣，大家看看就好。</p>\n<p><a href=\"http://lh6.ggpht.com/-XvdTkVXnHSs/UDXDXfe7prI/AAAAAAAAETc/QAKl_oprRvw/s1600-h/image%25255B27%25255D.png\"><img src=\"http://lh4.ggpht.com/-R0kdrGXpRbk/UDXDYnDsz1I/AAAAAAAAETo/NiIagDlAGpk/image_thumb%25255B15%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這邊如果沒有刪除掉Cloud Service的話，再取相同的名子，就沒辦法了喔!!所以如果要取相同名稱，記得要刪除Cloud Service。</p>\n<p><a href=\"http://lh3.ggpht.com/-q4CpbT1yKh4/UDXDZudvffI/AAAAAAAAETw/Df9cijMOrF8/s1600-h/image%25255B32%25255D.png\"><img src=\"http://lh6.ggpht.com/-CYIY33o9nzc/UDXDatc-E4I/AAAAAAAAET4/bhSba-xwCrQ/image_thumb%25255B18%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這邊設定高可用性，小弟我目前還不需要…</p>\n<p><a href=\"http://lh4.ggpht.com/-8jcpvQz1DbU/UDXDbox4wRI/AAAAAAAAET8/8v8KZaJL_j4/s1600-h/image%25255B37%25255D.png\"><img src=\"http://lh5.ggpht.com/-6Xn03qhvccI/UDXDcaCGO7I/AAAAAAAAEUE/ln2dRBVeSO0/image_thumb%25255B21%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>然後就會開始建立，當建立完後，要注意一下Status，通常會是Stop。( 下圖顯示Starting，那是因為小弟忘記截圖了… )</p>\n<p><a href=\"http://lh5.ggpht.com/-TLoduSOM0fE/UDXDdVYmskI/AAAAAAAAEUM/MTS6JbKWKT8/s1600-h/image%25255B41%25255D.png\"><img src=\"http://lh6.ggpht.com/-FptaFhMS6BI/UDXDeK98B9I/AAAAAAAAEUU/RyKGpuuYRV8/image_thumb%25255B23%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>如果是Stop，記得要選擇Restart，讓VM能重新啟動，下圖因為已經按過了，所以是呈現黑色不能按的狀況。</p>\n<p><a href=\"http://lh4.ggpht.com/-FWlrsbqAQZo/UDXDe1hzzAI/AAAAAAAAEUc/2YBSdEaPYds/s1600-h/image%25255B46%25255D.png\"><img src=\"http://lh3.ggpht.com/-BouRJCFiK6Y/UDXDfhon58I/AAAAAAAAEUk/zBXqlbcFMR8/image_thumb%25255B26%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這樣，除了Public IP不同外，大致上就都恢復了。</p>\n<h4>後記</h4>\n<p>其實有一點也需要注意的，這篇是講如何重建VM，但別忘了，如果這個VM真的要刪除，也別忘記去Storage裡面將VHD刪除，還有Cloud Service也要刪掉喔!!之前建立好幾台VM，結果Storage裡面存了一堆VHD…所以大家要注意喔!!</p>","excerpt":"當在Windows Azure上面建立了一台VM後，其實是會在Storage裡面創建一個VHD的，就算我們不小心刪除了剛剛建立好的VM，或是因為服務額度超過被停用，以至於此VM被移除，等等之類的狀況；乍看之下VM已經消失了，但實際上，我們還是可以利用原有的VHD…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"","tags":["Azure"]},"fields":{"slug":"/2012/08/23/Windows-Azure-注意-超過免費額度的話-東西會被自動移除/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Windows-Azure-注意-超過免費額度的話-東西會被自動移除.md"},"previous":{"frontmatter":{"path":null,"title":"Windows Azure - 將使用Access Control Service的網站部屬到Windows Azure","tags":["ASP.NET","ASP.NET MVC","Azure"]},"fields":{"slug":"/2012/08/28/Windows-Azure-將使用Access-Control-Service的網站部屬到Windows-Azure/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Windows-Azure-將使用Access-Control-Service的網站部屬到Windows-Azure.md"}}}}