{"componentChunkName":"component---src-templates-page-js","path":"/2020/06/08/GatsbyJS-Hexo_Migrate_To_GatsbyJS/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"GatsbyJS - 從 Hexo 轉移到 GatsbyJS","date":"08 June 2020","author":"Sky Chang","excerpt":"","tags":["Node.js","Hexo","GatsbyJS"],"coverImage":null},"id":"f0dea65a-a032-5f79-8a8d-b9489971aa4a","html":"<h2>前言</h2>\n<p><a href=\"http://skychang.github.io/2020/06/06/SkyBlog-Use_GatsbyJS_for_Blog/\">上一次</a>談論到，因小弟自己的私慾，選擇了 GatsbyJS，但其實沒有針對轉移的過程做比較詳細的敘述，所以就在這篇稍微紀錄一下，轉移的過程。</p>\n<p>注意，這篇不會詳細解釋 GatsbyJS，若對 GatsbyJS 有興趣，請參與<a href=\"https://www.gatsbyjs.org/\">官網</a>。</p>\n<p>喔，對了，這篇的環境是以 <strong>gatsby-starter-hello-friend</strong> 當作 start，不見得每個 Starter 都適合，但我相信透過這篇，大致上可以抓到如何去修改。</p>\n<h2>目標</h2>\n<ol>\n<li>將之前 v2 的網址與現在 v3 的網址能一樣，都是 <strong>skychang.github.io/年/月/日/文章名稱</strong> 的格式。</li>\n<li>有部分的頁面，例如 About、DevOp 等頁面，希望能使用 skychang.github.io/about 的方式呈現。</li>\n</ol>\n<p>當然，Hexo 的 NexT 樣板太強大，很難全部調整完，但至少這一步，希望能先將網址位置一樣先解決，不然無論是搜尋或是原本文章裡面的連結要修正都是很麻煩的一件事情。</p>\n<h2>開工</h2>\n<p>這次要修改的地方，大概就是如下圖位置。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 177px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7b7f972e11de84a719b829c86d143e98/ad6ca/2020-06-08-11-41-59.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 285.31073446327684%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,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'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2020 06 08 11 41 59\"\n        title=\"2020 06 08 11 41 59\"\n        src=\"/static/7b7f972e11de84a719b829c86d143e98/ad6ca/2020-06-08-11-41-59.png\"\n        srcset=\"/static/7b7f972e11de84a719b829c86d143e98/ad6ca/2020-06-08-11-41-59.png 177w\"\n        sizes=\"(max-width: 177px) 100vw, 177px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>templates 目錄，裡面有 page.js 和 tag.js，我們會修改裡面的 GraphQL，因為我們到時候會自訂自己的網址。</li>\n<li>gatsby-config.js 主要拿來設定 Plung 或是一些 blog 的名稱等等，這篇不會提到，但若是要調整 Blog 名稱、Title 等等，可以透過此 js 進行修改。</li>\n<li>gatsby-node.js 這次的重點，我們會簡單調整一下這個 js 檔案，詳細的過程邏輯，可以往後面看。</li>\n</ul>\n<h2>先談談 Markdown \b怎麼載入</h2>\n<p>在開始之前，我們要先知道一些東西，首先，如之前<a href=\"http://skychang.github.io/2020/06/06/SkyBlog-Use_GatsbyJS_for_Blog/\">文章</a>所提到的，GatsbyJS 是一個框架，他可以透過在 React 裡面撰寫 GraphQL，並且由 GraphQL 取得到的 JSON 資料 Bind 到 React 裡面來，這也就是 GatsbyJS 的基本。</p>\n<p>而因為這個特性，所以 GatsbyJS 其實有很多的 PlugIn 可以當資料來源，而我們這邊的資料來源當然就是 Markdown。</p>\n<h3>gatsby-transformer-remark</h3>\n<p>在預設的情況下，Markdown 這個 PlugIn 當然不會被載入進來，而要使用 Markdown 的資源，則必須使用 <a href=\"https://www.gatsbyjs.org/packages/gatsby-transformer-remark/?=gatsby-transformer-remark\">gatsby-transformer-remark</a>。</p>\n<p>當然，要使用 gatsby-transformer-remark 直接使用 npm install 即可。</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save gatsby-transformer-remark</code></pre></div>\n<p>載入完成後，我們還要在 gatsby-config.js 加上 gatsby-transformer-remark 就可以。而我們使用的這個範本，預設就已經有幫忙使用這個 PlugIn，而且也多加上了程式碼 Highlight、圖檔等功能，所以原則上不用修改。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 427px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17d5a9441cabe069cdc8d34e06f58e7a/86b21/2020-06-08-17-47-27.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 156.50000000000003%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAYAAADnTu3OAAAACXBIWXMAAAsSAAALEgHS3X78AAAEAElEQVRIx41VuZYjRRCUiw08dqW+j+r7ULfUknp0zPXAAA9rcACPfRj8Aw4W7/ED+62xkaXuRZqRZscIZdehqMyKzKzJer3GarXCaLc3PW2Hruuw2Wz03IZrDe1dmeNDp/Dh4YA/7w/4Y9/jrx8e8Nt6gd/bCl4QYiJ/WiwW+o9dt8Ri1aNZLLHmuO97vbYk5py7b2o8tSl+2W/x62GLn/sVnrY9npoSP6URXM/HJM9zZFmGqq4RJwmMIIHtKyRpgoTzskmQcE32pCpCpUJEHB/mNf7rWzz6Lr6ZTmEaBiYGfyzb5sYQMReUa0N5DqIBgesgDT2EtLPZDFPiq3fvcRv6+HdV447225kB27JgmiYmruvC5GBdJLhrS3Q5T24K3FQZdvMcmzJDGSso34PBfcqx8fd6jn+ImN9fk8wRMsIiJja98zwPMT306YXvudqrEaF3PNDm6e+I+yjEx92SJCa+MwYyzo+YOI4Dh6S+ipFv9kjaNYIoxpKeNrzoggSLLNaQuYzjiB7nkYI4Yw2ejTgS0vUw5qXfHFDe3KHuVhQh1hvkMPsEMvYGJ+wL0CELqUuorEC53iJMC7gMV0KYGUcY5qk1zsZnHo6Eco9yqksb5iXBRPV9VAyxjEPkKsA8UbyCAG0W6XHF+ZQqmyf3eEYo0gdJhnr/gKI/IM5yJIHHNHK1ODG/A9ok8LVVTDOxknbm4Om5h7Q2EVUNqt098q6Hk5Rwyw62F5yEerTGEPJI9sLDUfGoqJAu1sjXO5T0NOs28KIEbt7CZb1az+5tJLvoYagUfN6dVJC+F6kk2TzCMi8SvRBFKkaIFAln0/ea6FRlwVRCFcvqmA3rz0lfeCgtKGmWvMdWq9xQ2XkSaUWlLCXRxc6Z9LLffC1ttMpxqpNbVE7LStewKOkNpehKEQzl+WrIn1WWztOu0D7+iHy1Q9ZUWLJFmaalwzWvqHuVUFSOy5phd8zJHGmRIiN0m3um7Bc9FGGiKGJ4Lgz2vVFl0zAvkl0ifalyGLKRTs9akg7T/D/M57ieh9JJQqWTOp4v4QcBVQ61yqJuO7SzmsrLd0jB5G6ta3coKvusiPLmFgWR8i4VST3b4hNg6ydCngVpxN4g4BdFkbFitxFSTby9R1TO0ZQFurrEoqp0qxs7jPVqyJqQ7wZbl9Rxutxg3u9RsEkE7JEWX0NbpW8T5ZQwZrep94/H5sDGkM1bOHxK7TCBE8a6ni/l4EVCmTy2L/ZEvjENE7y+/V6H76UV/HYHTyU6VPNCCp2Lwu+AIgRU2nZc2Ewlx/WO8IOjR7aj1y55d56H3CRk0m3O88w4YmxnV/Lv7NWTdFF8FtMsvXryW8ruzEMh8wP/c82+lfQ5PgG0vHR8Yrp6tQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2020 06 08 17 47 27\"\n        title=\"2020 06 08 17 47 27\"\n        src=\"/static/17d5a9441cabe069cdc8d34e06f58e7a/86b21/2020-06-08-17-47-27.png\"\n        srcset=\"/static/17d5a9441cabe069cdc8d34e06f58e7a/56d15/2020-06-08-17-47-27.png 200w,\n/static/17d5a9441cabe069cdc8d34e06f58e7a/d9f49/2020-06-08-17-47-27.png 400w,\n/static/17d5a9441cabe069cdc8d34e06f58e7a/86b21/2020-06-08-17-47-27.png 427w\"\n        sizes=\"(max-width: 427px) 100vw, 427px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>到這邊後，其實就可以透過 GatsbyJS Cli Develop 模式</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">gatsbyjs develop</code></pre></div>\n<p>到 <a href=\"http://localhost:8000/___graphql\">http://localhost:8000/___graphql</a> 這個位置，用 GraphQL 查 allMarkdownRemark 和 markdownRemark，而 allMarkdownRemark 就是 目前所有的 MD，markdownRemark 則是單一筆 MD。</p>\n<p>下圖就是查找出單一筆的案例，這邊部探討 GraphQL，但可以簡單地看到，透過安裝 gatsby-transformer-remark 後，我們就可以從 GatsbyJS 取得到我們寫的 MD 檔案 ( 請注意，MD 檔案要放到 posts 底下 )，而且透過 GraphQL，可以透過 eq 進行 id 的查詢。 </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/263021c3ea5018a8c468d907b102655c/23039/2020-06-08-18-16-44.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.49999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABnElEQVQoz42Ti3KcMAxF/f+f13aSNk3bLCwLrF/IhuVh2FvJZHeaTDqtmTvSMOhwZdmqjxdchhHjNEGW1hrFS4HDoYCzDs7YLKtNlncOXefRBYLvul1EcL5Dqy2UPnpczJJh2/XK8AHkAscJa9qwzQnXecV1StjGBeQJdevhzx16/q53EVETBjbWh56BJ4+ZFmxpxcrFAwMF/NGSt1Ksv9XwX46gryd0j6yHKsdQskNvA9LILtYV8zghxrgXM/RPQSI/sbIggTGUnhuEF53fxcqhNwHKsMPBzBmSUgLxfnwMxA6sHejnGfS9yYqNR8+uBSbtq4bJwewDWZYFIYQ3wFt+A4bSgH60oKeG26zYpeR1dixu1bF10GH8f+DRoHvai8Wp7Nv+gzo7VWWtcZnWfwNfY2y45V9nxJPL7WZJzhpogKpaPmNhkj1HYiC9A75XPNnsRloPhcmti1MB9jxgVTQMjNN9KDeHf1sC8Z/L/aiIeOIi/6nMU1dFxf3zoZznOctam2+LSPK7+LZ4viHEe5iPjAzidTj3oRwMfgO280ywjutzMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2020 06 08 18 16 44\"\n        title=\"2020 06 08 18 16 44\"\n        src=\"/static/263021c3ea5018a8c468d907b102655c/78d47/2020-06-08-18-16-44.png\"\n        srcset=\"/static/263021c3ea5018a8c468d907b102655c/56d15/2020-06-08-18-16-44.png 200w,\n/static/263021c3ea5018a8c468d907b102655c/d9f49/2020-06-08-18-16-44.png 400w,\n/static/263021c3ea5018a8c468d907b102655c/78d47/2020-06-08-18-16-44.png 800w,\n/static/263021c3ea5018a8c468d907b102655c/64756/2020-06-08-18-16-44.png 1200w,\n/static/263021c3ea5018a8c468d907b102655c/23039/2020-06-08-18-16-44.png 1402w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>gatsby-node.js - onCreateNode</h3>\n<p>大致上了解 gatsby-transformer-remark 與 GraphQL 後，我們來順一下，整個頁面產生的流程。在正常情況下，我們希望我們輸入某個網址，舉例來說，可能是 skychang.github.io/about 後，就可以看到 about 的頁面。而目前，我們有了 about.md 產生出來的 html，但卻缺少了 skychang.github.io/about 對應到 about.md 產生出來的 Html 之方法，換言之，GastybyJS 裝了 gatsby-transformer-remark，並不會自動將 /about 對應到 about.md 產生出來的 html 這個資料欄位。</p>\n<p>當然，你可能會想，啊，有 id 啊，id 是唯一的，透過 id 的方式，就可以讓我們找到對應的文章，如上面 GraphQL 範例一樣。沒錯，這是對的，但可能不符合我們的需求。因為如果要用 id，我們就必須在網址上面加上此 id，例如 skychang.github.io/xxxxx-xxxxx-xxxx 或是 skychang.github.io/about?id=xxxxx-xxxxx-xxxxx ，但這些都不是我們要的。我們希望能直接透過 /about 來解決。但整個 markdownRemark 是沒有記錄到 /about 這個網址對應的關係的，只有記錄到 about.md 這個 File Name。</p>\n<p>那怎麼辦呢？，很簡單，不存在的東西，我們自己加一個進去就好。所以等下，我們會將 /about 這個值，加入到 markdownRemark 裡面，且自己定義一個 slug 這個欄位。這樣，當我們導向到 skychang.github.io/about 的時候，就可以透過 GraphQL 的 Filter，查找 slug eq \"/about\" ( 也就是 slug === \"/about\") 的方法，找到對應的文章。</p>\n<p>所以我們下一個要看的就是 gatsby-node.js。</p>\n<p>在 GatsbyJS <a href=\"https://www.gatsbyjs.org/tutorial/part-seven/\">官網</a>有提到，可以在 gatsby-node.js 裡面使用 onCreateNode 這個方法，這個方法就是當新的 Node 建立的時候，就會進行此流程，這個方法很適合在我們的需求，也就是每此有新的 Node 產生的時候，我們就將 slug 塞進去到 MarkdownRemark 這個節點裡面。</p>\n<p>底下是官方提供的程式碼，和樣板可能有些不同，但概念是相同的。當 node.internal.type === MarkdownRemark 的時候，我們就偷塞 slug 進去，而 slug 的值，會透過 createFilePath 這個方法 ( 要先 npm install gatsby-source-filesystem ) 來協助，快速的產生網址。而 createFilePath 這個方法會擷取 about.md 這個 File Name，並產生對應的 /about ( 換句話說，就是自動的幫我們截掉 .md，或是 about.md 前面的路徑 )，讓我們快速使用。而最後，就可以透過 createNodeField 來將 slug 塞進去 node 裡面 (大心)。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createFilePath <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-source-filesystem</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreateNode</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">,</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createNodeField <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">MarkdownRemark</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> slug <span class=\"token operator\">=</span> <span class=\"token function\">createFilePath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">,</span> basePath<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">pages</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">slug</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      value<span class=\"token operator\">:</span> slug<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>到這一步後，其實未來節點裡面，都會有 slug，而 slug 存的就是相對路徑的網址， ex : /about</p>\n<h3>gatsby-node.js - createPage</h3>\n<p>完成了 slug 偷偷塞入後，我們就可以透過 createPage 來建立頁面。嗯，什麼是建立頁面？別忘了 GatsbyJS 最後產生的是一堆 HTML，所以我們要在這邊定義ㄝ要產生哪堆 HTML，例如，我們有了 about.md 檔案， /about 這個 slug 資料，也有了 html 資料，但是沒產生出 .html 這個檔案，還是一切是空啊，所以 createPage 就負責處理這件事情。</p>\n<p>在官網的範例如下。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">path</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> actions <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions <span class=\"token comment\">// 後面會用到這個方法</span>\n  <span class=\"token comment\">// 既然要建立頁面，當然還是要一個 templates，這邊就不敘述 templates。</span>\n  <span class=\"token comment\">// 在 gatsby-starter-hello-friend 裡面，則是使用 index.js 當作範本。</span>\n  <span class=\"token keyword\">const</span> blogPostTemplate <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">src/templates/blog-post.js</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// 透過 GraphQL 查出所以的網址 ( slug )。</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    query loadPagesQuery ($limit: Int!) {\n      allMarkdownRemark(limit: $limit) {\n        edges {\n          node {\n            frontmatter {\n              slug\n            }\n          }\n        }\n      }\n    }\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> limit<span class=\"token operator\">:</span> <span class=\"token number\">1000</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>errors<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">throw</span> result<span class=\"token punctuation\">.</span>errors\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 查出所有資料後，利用 forEach 來產生所有的靜態頁面</span>\n    result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>allMarkdownRemark<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">edge</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// path 參數就是代表著實際的目錄位置，舉例來說，slug 為 /about，就代表著，會建立一個 about 的目錄，然後裡面產生 index.html 這個靜態頁面</span>\n        path<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>edge<span class=\"token punctuation\">.</span>node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>slug<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">// 同樣的，要產生頁面這邊也要有樣板，上面的 blog-post.js 代表著 List 列表，這邊的樣板，代表每一個文章的樣板</span>\n        component<span class=\"token operator\">:</span> blogPostTemplate<span class=\"token punctuation\">,</span>\n        context<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n         <span class=\"token comment\">// 這邊可以加上 context，來將資料傳遞到 blogPostTemplate 進行 bind。</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>到這邊為止·我們解釋了要執行 Markdown 的必要條件，所以，小弟之前有提過，GatsbyJS 其實真的不適合一般只想寫文章的人 QQ。</p>\n<h2>再談談如何符合我們的需求</h2>\n<p>前面講了很多基礎理論 ( 其實原本沒打算寫那麼多的，但結果... )，那現在來談談如何滿足我們的需求。</p>\n<p>如前面提到，我們的需求有兩個。</p>\n<ol>\n<li>將之前 v2 的網址與現在 v3 的網址能一樣，都是 <strong>skychang.github.io/年/月/日/文章名稱</strong> 的格式。</li>\n<li>有部分的頁面，例如 About、DevOp 等頁面，希望能使用 skychang.github.io/about 的方式呈現。</li>\n</ol>\n<p>所以，接下來要調整成我們的需求。</p>\n<h3>gatsby-node.js - onCreateNode</h3>\n<p>同樣，回到 gatsby-node.js 的 onCreateNode，在 gatsby-starter-hello-friend 樣板裡面，他其實是使用 markdown 裡面的 path 欄位來定義位置 ( 也就是說，不使用檔案名稱 )</p>\n<p>例如 :</p>\n<div class=\"gatsby-highlight\" data-language=\"markdown\"><pre class=\"language-markdown\"><code class=\"language-markdown\">title: GatsbyJS - 從 Hexo 轉移到 GatsbyJS\nauthor: \"Sky Chang\"\ncoverImage: \"\"\nexcerpt: ''\npath: \"/about\"\ndate: 2020-06-08 00:38:00</code></pre></div>\n<p>所以我們要修改 onCreateNode，讓他使用 date 和 FileName 來產生 slug。</p>\n<p>修改完後如下，這邊使用正規表示式，來 match date 這個欄位。也是小弟看到<a href=\"https://code.kpman.cc/2018/06/08/%E5%BE%9E-Hexo-%E5%88%B0-Gatsby/\">大大</a>的做法。但小弟的情境略有不同，所以進行了調整。( 嗯，我知道正規表示式寫的很醜，未來有機會再改吧 QQ )</p>\n<p>另外，我多加了 if 判斷，來判斷是否有在 markdown 裡面加上 path，若有的話，就以這個 path 為主，而不是以 FileName 為主。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token constant\">BLOG_POST_FILENAME_REGEX</span> <span class=\"token operator\">=</span>\n<span class=\"token regex\">/^(19|2[0-9][0-9]{2})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]).([0-1][0-9][0-9])Z$/</span><span class=\"token punctuation\">;</span>\n\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onCreateNode</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> node<span class=\"token punctuation\">,</span> getNode<span class=\"token punctuation\">,</span> boundActionCreators <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createNodeField <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> boundActionCreators<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// 確定是 Markdown 檔再做操作</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'MarkdownRemark'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">let</span> slug <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 判斷 markdown 裡面是有否有設定 Path，若無的話，使用 md 檔案名稱和日期。</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>slug <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> name <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">getNode</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>parent<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> match <span class=\"token operator\">=</span> <span class=\"token constant\">BLOG_POST_FILENAME_REGEX</span><span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> year <span class=\"token operator\">=</span> match<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> month <span class=\"token operator\">=</span> match<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> day <span class=\"token operator\">=</span> match<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// 組出我們要的 slug pattern</span>\n      slug <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>year<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>month<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>day<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 在該 node 上面多增加一個欄位，未來可以 Query</span>\n    <span class=\"token function\">createNodeField</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      node<span class=\"token punctuation\">,</span>\n      name<span class=\"token operator\">:</span> <span class=\"token string\">'slug'</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token operator\">:</span> slug<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3>gatsby-node.js - createPage</h3>\n<p>然後 CreatePage 的地方，就簡單了，因為基本邏輯不變，只是原本的路徑改為使用我們自訂的 slug。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"> <span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> node <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> index</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> previous <span class=\"token operator\">=</span> index <span class=\"token operator\">===</span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">:</span> sortedPages<span class=\"token punctuation\">[</span>index <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>node\n      <span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span>\n        index <span class=\"token operator\">===</span> sortedPages<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">:</span> sortedPages<span class=\"token punctuation\">[</span>index <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>node\n      <span class=\"token keyword\">const</span> isNextSameType <span class=\"token operator\">=</span> <span class=\"token function\">getType</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span>next <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">getType</span><span class=\"token punctuation\">(</span>next<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">const</span> isPreviousSameType <span class=\"token operator\">=</span>\n        <span class=\"token function\">getType</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token punctuation\">(</span>previous <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">getType</span><span class=\"token punctuation\">(</span>previous<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n      <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n        path<span class=\"token operator\">:</span> node<span class=\"token punctuation\">.</span>fields<span class=\"token punctuation\">.</span>slug<span class=\"token punctuation\">,</span><span class=\"token comment\">//node.frontmatter.path,</span>\n        component<span class=\"token operator\">:</span> pageTemplate<span class=\"token punctuation\">,</span>\n        context<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          type<span class=\"token operator\">:</span> <span class=\"token function\">getType</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          next<span class=\"token operator\">:</span> isNextSameType <span class=\"token operator\">?</span> next <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n          previous<span class=\"token operator\">:</span> isPreviousSameType <span class=\"token operator\">?</span> previous <span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> sortedPages<span class=\"token punctuation\">)</span></code></pre></div>\n<h3>index.js</h3>\n<p>接下來，我們的資料面都準備好後，可以來看一下 index.js，我們可以看到如下面的程式碼，我們可以透過預設的 postsQuery，將 GraphQL 塞進去，而我們就可以在執行 Index 這個方法的時候傳入資料進來，並且 Bind 到 React 上。</p>\n<p>而底下的 GraphQL 就會塞出所有 posts 目錄底下，請依據時間順序排序，再加上分頁的功能，來撈出資料，而且請注意，可以看到最底下，我們也補上了 slug 這個欄位，因為目前已經有這欄位了。\n( 原本的樣板，是沒有的，請自己補上 slug )</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> postsQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  query($limit: Int!, $skip: Int!) {\n    allMarkdownRemark(\n      filter: { fileAbsolutePath: { regex: \"//posts//\" } }\n      sort: { fields: [frontmatter___date], order: DESC }\n      limit: $limit\n      skip: $skip\n    ) {\n      edges {\n        node {\n          id\n          excerpt\n          frontmatter {\n            title\n            date(formatString: \"DD MMMM YYYY\")\n            path\n            author\n            excerpt\n            tags\n            coverImage {\n              childImageSharp {\n                fluid(maxWidth: 800) {\n                  ...GatsbyImageSharpFluid\n                }\n              }\n            }\n          }\n          fields{\n            slug\n          }\n        }\n      }\n    }\n  }\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>而最後，我們可以在 index.js 裡面看到裡面有一個 Post 這個 React Components，這個 Components 在 components/post.js，而 Index.js 會將相關資料送進去到 post.js ( 也是基本的 React 概念 )，而 post.js 就是首頁產生短短的預覽文章的 Components。</p>\n<p>( 我們這邊，就將底下原本 path={path} 改成我們自訂的 path={slug})</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">   <span class=\"token operator\">&lt;</span>Post\n    key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>id<span class=\"token punctuation\">}</span>\n    title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span>\n    date<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>date<span class=\"token punctuation\">}</span>\n    path<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>slug<span class=\"token punctuation\">}</span>\n    author<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>author<span class=\"token punctuation\">}</span>\n    coverImage<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>coverImage<span class=\"token punctuation\">}</span>\n    tags<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>tags<span class=\"token punctuation\">}</span>\n    excerpt<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>excerpt <span class=\"token operator\">||</span> autoExcerpt<span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">/</span><span class=\"token operator\">></span></code></pre></div>\n<p>而 post.js 裡面，就可以看到，從外面傳進來的 slug，到 Post Components 裡面後，會變成 path 變數，並塞到 Read me 這邊的超連結位置。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">  <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>path<span class=\"token punctuation\">}</span> className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>style<span class=\"token punctuation\">.</span>readMore<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Read more →\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span></code></pre></div>\n<h3>page.js</h3>\n<p>而最後，在 templates/page.js 底下，我們要修改 graphql，原本的樣板，是使用 path 進行 eq，而我們全部改用 slug 了，所以要改成使用 slug 進行 eq。</p>\n<p>另外，要注意，關於這個樣板，post.js 會由兩地方使用，一個是 index.js ( List )，一個是 page.js ( Detail )，而從 index.js 進來的時候，Post path 帶的是 slug，這個時候，會用到 Post path 的只有 h1 的超連結和 Read me。而從 page.js 進來的時候，其實沒用到 Post path，所以這有沒有值，其實無所謂，這也就是為什麼下面的 graphQL 將 path 註解，且又不加上 slug 的原因 ( 其實沒註解應該也沒差 )，另外，其實 tag.js 也會用到 page.js，但他的情境同 List。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  query($path: String) {\n    markdownRemark(fields: { slug: { eq: $path } }) {\n      frontmatter {\n        title\n        date(formatString: \"DD MMMM YYYY\")\n        # path\n        author\n        excerpt\n        tags\n        coverImage {\n          childImageSharp {\n            fluid(maxWidth: 800) {\n              ...GatsbyImageSharpFluid\n            }\n          }\n        }\n      }\n      id\n      html\n      excerpt\n    }\n  }\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>到這邊為止，我們就完成了所有的操作了</p>\n<h2>後記</h2>\n<p>落落長寫了非常長的一篇記錄，雖然 GatsbyJS 並非如一般的架站軟體一樣好用，但其實我滿喜歡他的強大和彈性，再加上優雅的 React 和 GraphQL 查詢資料系統和 PlugIn，更能為未來的 Blog 提供彈性，也很容易調整成往前相容。當然未來還有很多事情要做就是了 QQ</p>\n<p>而 GatsbyJS 轉換 Blog 系列，也暫時告一段落，未來如果有 GatsbyJS 的改版，再看看有沒有機會寫上來吧，我們下次見！</p>\n<h2>參考資料</h2>\n<ul>\n<li><a href=\"https://www.gatsbyjs.org/\">https://www.gatsbyjs.org/</a></li>\n<li><a href=\"https://www.gatsbyjs.org/packages/gatsby-transformer-remark/?=gatsby-transformer-remark\">https://www.gatsbyjs.org/packages/gatsby-transformer-remark/?=gatsby-transformer-remark</a></li>\n<li><a href=\"https://www.gatsbyjs.org/docs/node-apis/#createPages\">https://www.gatsbyjs.org/docs/node-apis/#createPages</a></li>\n<li><a href=\"https://code.kpman.cc/2018/06/08/%E5%BE%9E-Hexo-%E5%88%B0-Gatsby/\">https://code.kpman.cc/2018/06/08/%E5%BE%9E-Hexo-%E5%88%B0-Gatsby/</a></li>\n<li><a href=\"https://blog.crimx.com/2019/05/05/%E6%90%AD%E5%BB%BA-gatsby-%E5%8D%9A%E5%AE%A2%E5%9B%9B%EF%BC%9A%E5%85%BC%E5%AE%B9%20Jekyll%20%E5%BC%8F%E8%B7%AF%E5%BE%84/\">https://blog.crimx.com/2019/05/05/%E6%90%AD%E5%BB%BA-gatsby-%E5%8D%9A%E5%AE%A2%E5%9B%9B%EF%BC%9A%E5%85%BC%E5%AE%B9%20Jekyll%20%E5%BC%8F%E8%B7%AF%E5%BE%84/</a></li>\n<li><a href=\"https://medium.com/starbugs/gatsby-%E4%B8%8D%E6%98%AF%E6%9C%A8%E6%9D%91%E6%8B%93%E5%93%89%E4%B9%9F%E8%83%BD%E7%8E%A9%E8%BD%89-gatsby-feat-github-pages-fe2318a2e50d\">https://medium.com/starbugs/gatsby-%E4%B8%8D%E6%98%AF%E6%9C%A8%E6%9D%91%E6%8B%93%E5%93%89%E4%B9%9F%E8%83%BD%E7%8E%A9%E8%BD%89-gatsby-feat-github-pages-fe2318a2e50d</a></li>\n</ul>","excerpt":"前言 上一次談論到，因小弟自己的私慾，選擇了 GatsbyJS，但其實沒有針對轉移的過程做比較詳細的敘述，所以就在這篇稍微紀錄一下，轉移的過程。 注意，這篇不會詳細解釋 GatsbyJS，若對 GatsbyJS 有興趣，請參與官網。 喔，對了，這篇的環境是以 gatsby…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"GitHub - 使用 Action CI/CD 部署 GatsbyJS","tags":["GitHub","GatsbyJS","DevOps","Node.js","CI/CD"]},"fields":{"slug":"/2020/06/07/GitHub-Use_GitHub_Action_Deploy_GatsbyJS/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/GitHub-Use_GitHub_Action_Deploy_GatsbyJS/GitHub-Use_GitHub_Action_Deploy_GatsbyJS.md"},"previous":null}}}