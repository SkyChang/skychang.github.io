{"componentChunkName":"component---src-templates-page-js","path":"/2011/01/25/ASP-NET-MVC-、AJAX、img標籤當button的問題/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"ASP.NET MVC 、AJAX、img標籤當button的問題","date":"25 January 2011","author":"Sky Chang","excerpt":null,"tags":["ASP.NET MVC","HTML","JavaScript"],"coverImage":null},"id":"11378678-4d90-5b61-bec1-0ca3a7f267f7","html":"<p>在ASP.NET MVC 2裡，當使用ajax helper時，如果使用不當，是會造成個瀏覽器的一些問題。</p>\n<p>但如果您是使用ASP.NET MVC 3，就不用繼續看下去了。</p>\n<pre class=\"brush: js\">function send() {\n  $(&quot;#webForm&quot;).trigger(&quot;onsubmit&quot;);\n}\n</pre>\n<p>中間程式碼略<a href=\"#\"></a></p>\n<pre class=\"brush: html\">&lt;a href=&quot;#&quot;&gt;\n&lt;img src=&quot;&quot; alt=&quot;send&quot; name=&quot;Test&quot; width=&quot;150&quot;\nheight=&quot;37&quot; border=&quot;0&quot; id=&quot;Test&quot;\nonclick=&quot;send();&quot; /&gt;\n&lt;/a&gt;\n</pre>\n<p>上面這段程式碼看請來滿正常的，畢竟在設計師設計的時候，</p>\n<p>通常都不會使用標準的Button控制項來做Submit..</p>\n<p>通常都會將Button包成漂漂的img，然後外面包一個a標籤，</p>\n<p>然後在img裡面加上JavaScript的觸發事件，</p>\n<p>也就是onClick事件，來觸發JavaScript的send方法，</p>\n<p>畢竟有的時候會需要JavaScript做驗證，</p>\n<p>然後驗證完成後，在觸發submit事件，</p>\n<p>這是一個行之多年的爛方法，</p>\n<p>當然，我們也知道利用a標籤來框住img標籤的這個方法很蠢，</p>\n<p>但是使用到現在，也沒發生什麼問題，從設計師那邊接手過來的HTML是這樣，</p>\n<p>時間緊迫，也懶得再去修改，但結果，事情就這樣的發生了。</p>\n<p>平常可能還沒甚麼問題，</p>\n<p>但在使用Ajax helper的時候，卻會產生大大的問題，</p>\n<p>Ajax helper配合上Model的驗證時，我們雖然在.cs裡面只需要在多加上幾行，</p>\n<p>就會有強大的效過，但也產生大大的問題，</p>\n<p>回來看這由Ajax helper產生的html，卻會在form裡面插入了兩個事件，</p>\n<p>onClick與onSubmit，也因如此，在配合上各家瀏覽器的\"風格\"不同，造就了不同的結果....</p>\n<p>首先，看到jQuery的部分，為何不寫成 $(\"webForm\").submit();</p>\n<p>就是因為在ie系列，配合上form的onSubmit時會送出兩次的post....</p>\n<p>至於為什麼，我也只能猜測，在ie上，javascript的submit會直接送出表單，然後onSubmit事件會再送出一次，</p>\n<p>那改成$(\"webForm\").trigger(\"onsubmit\");這樣寫就沒問題了嗎?</p>\n<p>錯.....</p>\n<p>如果使用這樣的寫法，firefox是不會有動作的....</p>\n<p>原因似乎是因為onSubmit標準上是不會送出submit事件的( ie除外，所以ie會post兩次= = )</p>\n<p>所以要怎麼辦呢...要改成以下程式碼</p>\n<pre class=\"brush: js\">function send() {\n$(&quot;#webForm&quot;).trigger(&quot;onsubmit&quot;);\n}\n</pre>\n<p>中間程式碼略</p>\n<pre class=\"brush: html\">&lt;input type=&quot;image&quot; src=&quot;&quot;  alt=&quot;send&quot; name=&quot;Test&quot; id=&quot;Test&quot;\nonclick=&quot;send();&quot; /&gt;\n</pre>\n<p>這樣IE，Firefox都可以了，為何會這樣，我的推測，在HTML裡，input送出的事件，會呼叫onSubmit，然後再送出。</p>\n<p>所以這樣子，ie就不會送出兩次，firefox也可以順利執行。</p>\n<p>所以，正規的HTML寫法還是很重要..</p>","excerpt":"在ASP.NET MVC 2裡，當使用ajax helper時，如果使用不當，是會造成個瀏覽器的一些問題。 但如果您是使用ASP.NET MVC 3，就不用繼續看下去了。 中間程式碼略 上面這段程式碼看請來滿正常的，畢竟在設計師設計的時候， 通常都不會使用標準的Button…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"使用Linq進行動態查詢","tags":["Entity Framework","Linq"]},"fields":{"slug":"/2010/10/04/使用Linq進行動態查詢/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/使用Linq進行動態查詢.md"},"previous":{"frontmatter":{"path":null,"title":"ASP.NET MVC - Area與Controller之Routing問題","tags":["ASP.NET MVC"]},"fields":{"slug":"/2011/01/25/ASP-NET-MVC-Area與Controller之Routing問題/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/ASP-NET-MVC-Area與Controller之Routing問題.md"}}}}