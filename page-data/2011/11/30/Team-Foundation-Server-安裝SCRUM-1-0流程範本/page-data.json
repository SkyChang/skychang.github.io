{"componentChunkName":"component---src-templates-page-js","path":"/2011/11/30/Team-Foundation-Server-安裝SCRUM-1-0流程範本/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Team Foundation Server - 安裝SCRUM 1.0流程範本","date":"30 November 2011","author":"Sky Chang","excerpt":null,"tags":["Scrum","SharePoint","TFS","Visual Studio"],"coverImage":null},"id":"0907d3c4-2b61-53ef-bced-b2cac5d3565c","html":"<p><font color=\"#ff0000\">2012 11/27 更新 目前TFS 2012已經內建範本，而TFS 2010測試過後的結果，還是不建議大家使用Scrum 1.0的範本，一個是Sharepoint不能完整的支援，而內容也不如TFS 2012的強大，如果沒有TFS 2012，還在使用TFS 2010的人，還是建議使用預設敏捷的範本就好，不要使用這個Scrum 1.0的範本。</font></p>\n<p>最近在協助導入SCRUM，雖然MSF已經很好用了，但是有些名詞畢竟和原本的SCRUM有點不同，為了讓大家更清楚的了解，所以決定在TFS上採用SCRUM範本。</p>\n<p>其實網路上也找到滿多的資料，大家也可以去參考最後面的參考資料列表，不過既然自己要做一次，就把這個紀錄留下吧。</p>\n<p>下面這個網址是SCRUM1.0範本的下載網址，因為後續要使用Visual Studio 2010進行安裝，所以我會把此檔案下載到本機端；下載安裝完後，預設會裝到。</p>\n<blockquote>\n<p>C:\\Program Files (x86)\\Microsoft\\Microsoft Visual Studio Scrum 1.0 </p>\n</blockquote>\n<p>的目錄下。</p>\n<p><a href=\"http://visualstudiogallery.msdn.microsoft.com/59ac03e3-df99-4776-be39-1917cbfc5d8e/\" title=\"http://visualstudiogallery.msdn.microsoft.com/59ac03e3-df99-4776-be39-1917cbfc5d8e/\">http://visualstudiogallery.msdn.microsoft.com/59ac03e3-df99-4776-be39-1917cbfc5d8e/</a></p>\n<p><a href=\"http://lh4.ggpht.com/-HfGcjyz3sEo/TtXQYTyxVbI/AAAAAAAABFI/32BXBK94iJo/s1600-h/image%25255B3%25255D.png\"><img src=\"http://lh3.ggpht.com/-Ua2Qy8dM1Mc/TtXQZN29K9I/AAAAAAAABFQ/CgAjycHFh4s/image_thumb%25255B1%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>裝完後要先修改一下此樣板的設定檔，才能符合中文版的SharePoint使用，如果是使用英文版的SharePoint，可以略過此步驟。</p>\n<p>打開C:\\Program Files (x86)\\Microsoft\\Microsoft Visual Studio Scrum 1.0\\Process Template\\Windows SharePoint Services\\WssTasks.XML 檔案，並將如圖下的1033改成1028。</p>\n<p><a href=\"http://lh5.ggpht.com/-CDzcOcC2cK8/TtXQZ2r4ozI/AAAAAAAABFU/EFYeQvlFtKc/s1600-h/image%25255B41%25255D.png\"><img src=\"http://lh3.ggpht.com/-crt5z5q2cvg/TtXQbhULY_I/AAAAAAAABFg/jKYSWAKfwFc/image_thumb%25255B21%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>存檔後，啟動Visual Studio 2010；既然要給TFS安裝SCRUM，那就一定要連接到TFS上，然後於在選取流程範本管理員。</p>\n<p><a href=\"http://lh4.ggpht.com/--6VFsIfV4J0/TtXQcXbZQnI/AAAAAAAABFo/LBL-DoJw_Zg/s1600-h/image%25255B8%25255D.png\"><img src=\"http://lh5.ggpht.com/-yUkcXrx6pCU/TtXQduk5_kI/AAAAAAAABFs/VCxEH35oSSE/image_thumb%25255B4%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>然後選擇上載，路徑則選擇剛剛安裝完的SCRUM樣板。</p>\n<blockquote>\n<pre>C:\\Program Files (x86)\\Microsoft\\Microsoft Visual Studio Scrum 1.0\\Process Template</pre>\n</blockquote>\n<p><a href=\"http://lh3.ggpht.com/-xtZ-ciIyXps/TtXQgknPxMI/AAAAAAAABF4/rGaUdVJxKRs/s1600-h/image%25255B16%25255D.png\"><img src=\"http://lh5.ggpht.com/-QVBG8_9xMyE/TtXQoL-vQ3I/AAAAAAAABGA/PnvOudcJ-pI/image_thumb%25255B8%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>安裝過程中。</p>\n<p><a href=\"http://lh5.ggpht.com/-n1SqWBIqGso/TtXQo5BoZEI/AAAAAAAABGI/EIKl8aoiuXg/s1600-h/image%25255B23%25255D.png\"><img src=\"http://lh3.ggpht.com/-iw9iX-m9Y1s/TtXQprCrkdI/AAAAAAAABGQ/nyfgl9Pbrg8/image_thumb%25255B11%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>安裝完成後，就會出現SCRUM樣板。</p>\n<p><a href=\"http://lh3.ggpht.com/-xZhTNbUrzRg/TtXQqm3j2LI/AAAAAAAABGY/67b7B8gpaB8/s1600-h/image%25255B24%25255D.png\"><img src=\"http://lh3.ggpht.com/-_Su3tgQEWbU/TtXQrRyMq9I/AAAAAAAABGg/lWykL6fXSUU/image_thumb%25255B12%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>但此時還沒結束喔，我們還要幫SharePoint安裝Dashboard；</p>\n<p>將</p>\n<blockquote>\n<p>C:\\Program Files (x86)\\Microsoft\\Microsoft Visual Studio Scrum 1.0\\Project Portal\\Microsoft.TeamFoundation.SharePoint.Scrum.wsp</p>\n</blockquote>\n<p>複製到SharePoint 伺服器底下。</p>\n<p>然後執行以下命令，第二個步驟，參數-filename後面是要輸入你存放Microsoft.TeamFoundation.SharePoint.Scrum.wsp 這個檔案的路徑。</p>\n<ul>\n<li>SET STSADM=\"%CommonProgramFiles%\\Microsoft Shared\\web server extensions\\12\\BIN\\stsadm.exe\"<li>%STSADM% -o addsolution -filename Microsoft.TeamFoundation.SharePoint.Scrum.wsp<li>%STSADM% -o deploysolution -name microsoft.teamfoundation.sharepoint.scrum.wsp -immediate -allowGacDeployment<li>%STSADM% -o execadmsvcjobs</li>\n</ul>\n<p>最後在使用此命令來確認是否安裝成功</p>\n<blockquote>\n<p>%STSADM% -o enumsolutions</p>\n</blockquote>\n<p>如果訊息裡面有這段，就表示安裝完成。</p>\n<pre class=\"brush: xml;\">&lt;Solution Name=\"microsoft.teamfoundation.sharepoint.scrum.wsp\"&gt;\n  &lt;Id&gt;675b95f2-bf14-4d60-9b80-2a696c9fe80c&lt;/Id&gt;\n  &lt;File&gt;Microsoft.TeamFoundation.SharePoint.Scrum.wsp&lt;/File&gt;\n  &lt;Deployed&gt;TRUE&lt;/Deployed&gt;\n  &lt;WebApplicationSpecific&gt;FALSE&lt;/WebApplicationSpecific&gt;\n  &lt;ContainsGlobalAssembly&gt;TRUE&lt;/ContainsGlobalAssembly&gt;\n  &lt;ContainsCodeAccessSecurityPolicy&gt;FALSE&lt;/ContainsCodeAccessSecurityPolicy&gt;\n  &lt;LastOperationResult&gt;DeploymentSucceeded&lt;/LastOperationResult&gt;\n  &lt;LastOperationTime&gt;...&lt;/LastOperationTime&gt;\n&lt;/Solution&gt;\n</pre>\n<p>這樣就完成了。</p>\n<p>如後補充一下，如果沒有修改WssTasks.XML，而新增Team Project的話，會出現如下錯誤。</p>\n<p><a href=\"http://lh5.ggpht.com/-eHTW6hAjHB0/TtXQsyr8IpI/AAAAAAAABGo/SS8_oaBRI0I/s1600-h/image%25255B28%25255D.png\"><img src=\"http://lh6.ggpht.com/-CSxQ4Vb0PIY/TtXQvWu70nI/AAAAAAAABGw/SAyBba7axCY/image_thumb%25255B14%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<blockquote>\n<p><strong>錯誤</strong>\n[新增 Team 專案精靈] 在嘗試於下列 SharePoint Web 應用程式上建立網站時發生錯誤: 。 </p>\n<p>**說明**\n[專案建立精靈] 將文件上載至下列執行 SharePoint 產品的伺服器時發生問題: 。此時尚無法判斷失敗的原因。由於作業失敗，精靈無法完成建立 Team 專案。 \n<p>**使用者的動作**\n請聯絡位於下列位置且執行 SharePoint 產品的伺服器的系統管理員: 。確認伺服器正在執行，且您具備足夠的權限可建立專案。此外，您也可以在專案建立記錄檔中找到其他有用的資訊。記錄檔會顯示精靈在發生錯誤時採取的每一個動作，還會包含有關錯誤的其他詳細資料。\n</blockquote>\n<p>我們去查看記錄檔，可以看到以下訊息。</p>\n<blockquote>\n<p>例外狀況訊息: TF249033: 沒有可供此地區設定識別項 (LCID) 使用的網站範本。網站範本名稱是: TFS2010 Agile Dashboard。LCID 是: 1033。 (型別 TeamFoundationServerException)</p>\n<p>例外狀況堆疊追蹤:    於 Microsoft.TeamFoundation.Client.SharePoint.SharePointTeamFoundationIntegrationService.HandleException(Exception e)\n   於 Microsoft.TeamFoundation.Client.SharePoint.SharePointTeamFoundationIntegrationService.CreateSite(String webApplicationUrl, String absolutePath, String title, String description, UInt32 localeId, String template, Boolean templateIsTitle, String ownerLogin, String ownerName, String ownerEmail, Guid configurationServerId, Guid projectCollectionId)\n   於 Microsoft.TeamFoundation.Client.SharePoint.WssUtilities.CreateSite(ICredentials credentials, Uri adminUrl, WssSiteData siteCreationData, Guid configurationServerId, Guid projectCollectionId)\n   於 Microsoft.TeamFoundation.Client.SharePoint.WssUtilities.CreateSite(WssSiteData siteCreationData, TeamProject settings)\n   於 Microsoft.VisualStudio.TeamFoundation.WssSiteCreator.CreateSite(WssSiteData siteCreationData, WssCreationContextWrapper contextWrapper)\n   於 Microsoft.VisualStudio.TeamFoundation.WssSiteCreator.HandleSiteCreation(WssCreationContextWrapper contextWrapper, XmlNode taskNode)</p>\n<p>內部例外狀況詳細資料:</p>\n<p>例外狀況訊息: TF249033: 沒有可供此地區設定識別項 (LCID) 使用的網站範本。網站範本名稱是: TFS2010 Agile Dashboard。LCID 是: 1033。 (型別 SoapException)SoapException 詳細資訊: &#x3C;detail exceptionType=\"TeamFoundationServerException\" /></p>\n</blockquote>\n<p>反正簡單的說，就是找不到英文的網站範本，因為沒改的話會去找1033，所以我們要調整成1028 ( 繁體中文 )。</p>\n<p>此外，也有查到說安裝英文語言包，而不用改XML的方法，但是我測試過後，這樣是沒用的，還是一定要改XML就是了。</p>\n<h4>參考網址</h4>\n<ul>\n<li><a href=\"http://blogs.msdn.com/b/cdndevs/archive/2010/07/19/microsoft-visual-studio-scrum-1-0.aspx\" title=\"http://blogs.msdn.com/b/cdndevs/archive/2010/07/19/microsoft-visual-studio-scrum-1-0.aspx\">http://blogs.msdn.com/b/cdndevs/archive/2010/07/19/microsoft-visual-studio-scrum-1-0.aspx</a><li><a href=\"http://charlesbc.blogspot.com/2010/08/visual-studio-scrum-10.html\" title=\"http://charlesbc.blogspot.com/2010/08/visual-studio-scrum-10.html\">http://charlesbc.blogspot.com/2010/08/visual-studio-scrum-10.html</a></li>\n</ul>","excerpt":"2012 11/27 更新 目前TFS 2012已經內建範本，而TFS 2010測試過後的結果，還是不建議大家使用Scrum 1.0的範本，一個是Sharepoint不能完整的支援，而內容也不如TFS 2012的強大，如果沒有TFS 2012，還在使用TFS 201…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"Team Foundation Server - TF252031、TF250001、TF249031 和 安裝TFS的權限注意事項","tags":["Reporting Services","SharePoint","SQL Server","TFS"]},"fields":{"slug":"/2011/11/26/Team-Foundation-Server-TF252031、TF250001、TF249031-和-安裝TFS的權限注意事項/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Team-Foundation-Server-TF252031、TF250001、TF249031-和-安裝TFS的權限注意事項.md"},"previous":{"frontmatter":{"path":null,"title":"Scrum - 快速上手","tags":["Scrum","TFS"]},"fields":{"slug":"/2011/11/30/Scrum-快速上手/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Scrum-快速上手.md"}}}}