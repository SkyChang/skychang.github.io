{"componentChunkName":"component---src-templates-page-js","path":"/2015/07/30/Azure上的Ubuntu與遠端桌面管理-VNC/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Azure上的Ubuntu與遠端桌面管理 VNC","date":"30 July 2015","author":"Sky Chang","excerpt":null,"tags":["Azure","Linux","Ubuntu","VM"],"coverImage":null},"id":"af7553a7-685c-5d5e-b66f-1687997f17a0","html":"<p>大家應該都很清楚，透過Azure可以輕鬆的建立Windows的VM，但實際上，要建立Linux的VM也一樣容易， </p>\n<p>而本篇，就由小弟來為大家介紹Ubuntu in Azure。</p>\n<h2>建立Ubuntu VM 與 登入</h2>\n<p>建立Linux VM的方式基本上與建立Windows沒兩樣，這邊小弟選擇了Linux裡面大家很常使用的Ubuntu來作為教學。</p>\n<p>而這邊要特別注意，我們選擇的是Ubuntu 14.10的版本，而後面開啟遠端設定的版本，也是針對14.10，如果您使用了別的版本，那可能會照成設定失敗的狀況。</p>\n<p><img src=\"https://lh3.googleusercontent.com/0jxoESgIEeD0b9FtXDfixmIKxewxrk3gMtKbIhn1ZTA=s600\" alt=\"enter image description here\" title=\"01.png\"></p>\n<p>接下來，我們選擇 Ubuntu 14.10的版本，其餘的設定和建立一般的Windows Server差不多，一樣可以選擇地區或是資源群組。</p>\n<p><img src=\"https://lh3.googleusercontent.com/gWftkxYQXCwVbZDi3cCkB6VptTiCkMbx2uYHyiqRZy0=s600\" alt=\"enter image description here\" title=\"02.png\"></p>\n<p>完成之後，我們沒辦法和 Windows 一樣，直接下載 RDP 的檔案來連線，我們必須透過 SSH 來進行連線。 </p>\n<p>這邊要注意一下，我們要在後面加上 -l 的參數，並且帶入帳號，不然他預設會用我們目前終端機的帳號，第一次登入的時候，會要求將金鑰寫入，所以這邊一定要按下 yes ，然後就可以輸入帳號密碼了～</p>\n<p><img src=\"https://lh3.googleusercontent.com/SAHUQQkMVDuwxoy_l1Wl89gR_fbodcPZSJvjgAIZnbo=s600\" alt=\"enter image description here\" title=\"03.png\"></p>\n<h2>VNC 開始之前</h2>\n<p>基本上，到上面那邊的操作，就已經可以順利登入了，但小弟畢竟是懶惰的，如果遠端登入也有 UI 那不是更棒嗎！！而目前，Ubuntu已經預設提供了 VNC 外，也提供透過Microsoft Remote Desktop ( RDP )的方式來遠端登入，( 其實底層還是 VNC 只是中間透過xRDP 來進行命令的轉換 )，基本上透過 RDP 的速度會比較快，但是目前 Ubuntu 預設的桌面和 xRDP 有一些衝突，所以要另外安裝其他的桌面環境，而這邊為了初步體驗順利，我們就直接來看看，透過 VNC 的方式來進行遠端登入。</p>\n<p>但開始前，小弟先提醒大家，目前小弟測試使用 VNC 登入，效果不是很好，滿慢的，所以有這個需求的朋友，可能要先有心理準備…</p>\n<h2>更新 Ubuntu 與 安裝 Ubuntu Desktop</h2>\n<p>裝完 Ubuntu 後，第一步當然就是更新…所以我們要下</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;span class=&quot;hljs-built_in&quot;&gt;sudo&lt;/span&gt; apt-get update</code></pre></div>\n<p>來更新。</p>\n<p><img src=\"https://lh3.googleusercontent.com/fbtACjObO6UalSvmrBLJJuoKj63mlukcw3esrLJyK5M=s600\" alt=\"enter image description here\" title=\"04.png\"></p>\n<p>接下來，我們就可以裝預設的桌面環境了。</p>\n<p>sudo apt-get install ubuntu-desktop</p>\n<p>這邊裝的過程有點久，大家可能要耐心等待一下。</p>\n<p><img src=\"https://lh3.googleusercontent.com/-iPEJdkdhjKzbq1Qglby-77Pfd3zCkxoSiPdQDdk988=s600\" alt=\"enter image description here\" title=\"05.png\"></p>\n<h2>安裝 x11vnc 與 設定</h2>\n<p>接下來，我們要安裝 x11vnc 來當作我們的 VNC Server </p>\n<p>sudo apt-get install x11vnc</p>\n<p><img src=\"https://lh3.googleusercontent.com/npNXmCdKfgoq8Kcck4xphBl3zVl_30oyBgpfM8Amfjg=s600\" alt=\"enter image description here\" title=\"06.png\"></p>\n<p>安裝完成之後，要設定遠端的登入密碼。 </p>\n<p>sudo x11vnc -storepasswd /etc/x11vnc.pass</p>\n<p><img src=\"https://lh3.googleusercontent.com/7b0bJaCNAuzowwVDCCDPBIYW7c4xvhbU5kGIH9fLL5s=s600\" title=\"07.png\"></p>\n<p>最後，我們要到/etc/init/的目錄下，新增加x11vnc.conf這個檔案</p>\n<p>小弟這邊直接使用 vi 來進行編輯。</p>\n<p>sudo vi /etc/init/x11vnc.conf</p>\n<p>內容如下，但要小心/usr/bin/x11vnc 等一長串，其實是”同一行”!!</p>\n<p>start on login-session-start  </p>\n<p>script  </p>\n<p>/usr/bin/x11vnc -xkb -auth /var/run/lightdm/root/:0 -noxrecord -noxfixes -noxdamage -rfbauth /etc/x11vnc.pass -forever -bg -rfbport 5900 -o /var/log/x11vnc.log  </p>\n<p>end script</p>\n<p><img src=\"https://lh3.googleusercontent.com/hzuFIsaEmhzfjA5lgOs9U2udnuugIvwiMW9t_fV9BfE=s600\" alt=\"enter image description here\" title=\"08.png\"></p>\n<p>存擋完成之後，我們就可以重新開啟Ubuntu</p>\n<p>sudo reboot</p>\n<p><img src=\"https://lh3.googleusercontent.com/my6_bvEGpCymQgB40DSkTnRXwDGMz8v_9B-QXde5jXQ=s600\" alt=\"enter image description here\" title=\"09.png\"></p>\n<h2>設定 Azure 端點</h2>\n<p>當然，最重要的，也別忘記設定 Azure 的端點。</p>\n<p><img src=\"https://lh3.googleusercontent.com/vNbu89lf5rzyj9mA34MyWCsjTcRHjZS6oAsMOHeeGGc=s600\" alt=\"enter image description here\" title=\"20.png\"></p>\n<h2>連線</h2>\n<p>接下來，就可以透過 VNC 的軟體進行登入嚕！！ （ 小弟這邊是直接使用 OSX 內建的 VNC 軟體 ） </p>\n<p>只要在 Safari 裡面輸入 VNC://網址，就可以進行登入</p>\n<p><img src=\"https://lh3.googleusercontent.com/UE-q2rFMoVrv46TJW0ZD-pzx_D_f-tKfrd06H5kWKX8=s600\" alt=\"enter image description here\" title=\"21.png\"></p>\n<p>接下來輸入密碼</p>\n<p><img src=\"https://lh3.googleusercontent.com/SQWEqclYgs44pEYdXtlZ2u6RFkVpbHWGaNJkYy-6T5A=s600\" alt=\"enter image description here\" title=\"22.png\"></p>\n<p>然後就可以成功進去了！！(這邊的登入密碼，就是建立 VM 時所 Key 的密碼，但有時候會因為網路的延遲，造成大小寫轉換失效，所以如果進不去，可以多試驗幾次)</p>\n<p><img src=\"https://lh3.googleusercontent.com/x3IwQWV_-U1iDpSSKuEk98Ckl1Vrfpt-zWPNm23nf0Q=s600\" alt=\"enter image description here\" title=\"23.png\"></p>\n<h2>總結</h2>\n<p>基本上，這樣就可以輕鬆的登入到 Ubuntu 的遠端畫面，但小弟建議，還是用終端機吧…真的快很多….</p>\n<h2>參考資料</h2>\n<ul>\n<li><a href=\"http://c-nergy.be/blog/?p=5870\">http://c-nergy.be/blog/?p=5870</a></li>\n<li><a href=\"http://jamyy.us.to/blog/2015/04/7354.html\">http://jamyy.us.to/blog/2015/04/7354.html</a></li>\n<li><a href=\"http://askubuntu.com/questions/556358/desktop-sharing-on-14-10\">http://askubuntu.com/questions/556358/desktop-sharing-on-14-10</a></li>\n</ul>","excerpt":"大家應該都很清楚，透過Azure可以輕鬆的建立Windows的VM，但實際上，要建立Linux的VM也一樣容易，  而本篇，就由小弟來為大家介紹Ubuntu in Azure。 建立Ubuntu VM 與 登入 建立Linux VM的方式基本上與建立Windows…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"Azure - 使用 Azure DNS Service","tags":["Azure","DNS"]},"fields":{"slug":"/2015/07/29/Azure-Use_DNS_Service/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/Azure-Use_DNS_Service/Azure-Use_DNS_Service.md"},"previous":{"frontmatter":{"path":null,"title":"在Ubuntu運行Docker","tags":["Azure","Docker","Linux","Ubuntu","VM"]},"fields":{"slug":"/2015/07/30/在Ubuntu運行Docker/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/在Ubuntu運行Docker.md"}}}}