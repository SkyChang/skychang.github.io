{"componentChunkName":"component---src-templates-page-js","path":"/2013/02/15/Windows-Server-使用Win8管理Windows-Server/","result":{"data":{"markdownRemark":{"frontmatter":{"title":"Windows Server - 使用Win8管理Windows Server","date":"15 February 2013","author":"Sky Chang","excerpt":null,"tags":["Windows","Windows Server"],"coverImage":null},"id":"02791aaa-8b44-5e33-8822-ee42e48f678e","html":"<p>年底這段時間，果然是最忙的，Blog也超久沒更新，雖然有滿多東西可以寫得，但也一直沒時間寫阿!!，而今天，剛好利用一點小時間，就順便寫一下關於IT的東西，不過我畢竟不是把IT當作主力的XDD，大家就隨意看看吧。</p>\n<p>過年大掃除，順便把家裡的舊電腦，裝起Windows Server 2012起來，而且因為搭配Hyper-V，所以就可以虛擬很多台電腦起來玩。</p>\n<p>但是雖然很多台電腦，但要管理就會很麻煩，像以前，小弟都是一台一台的遠端桌面登進去，所以就會看到一堆遠端桌面的視窗…</p>\n<p>但其實，我們可以使用工具，透過伺服器管理工具，就可以在Windows 8下，輕鬆的管理和查看Server的狀態喔!!</p>\n<p>首先，我們要先去下面那個位置下載，有區分32和64位元版本，就看目前的windows 8是哪個版本就下載哪個版本。</p>\n<p><a href=\"http://www.microsoft.com/zh-tw/download/details.aspx?id=28972\" title=\"http://www.microsoft.com/zh-tw/download/details.aspx?id=28972\">http://www.microsoft.com/zh-tw/download/details.aspx?id=28972</a></p>\n<p><a href=\"http://lh3.ggpht.com/-RK0Nt9KX6Vo/UR39BG0BA5I/AAAAAAAAFz8/mFxnbfobQRs/s1600-h/image3.png\"><img src=\"http://lh5.ggpht.com/-axxjTyBZ9jA/UR39CTFiPvI/AAAAAAAAF0E/JLrfonTT4Dk/image_thumb1.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>例外，要注意一下，如果之前有安裝過，記得移除，如下是官方的重要事項說明</p>\n<blockquote>\n<p>**重要事項： **在您安裝 Windows 8 的遠端伺服器管理工具之前，請先從電腦移除所有舊版的系統管理工具包或遠端伺服器管理工具，包括較早的發行前版本以及不同語言或地區的工具版本。一次只能在電腦上安裝一份遠端伺服器管理工具。 如果您已經從 Windows 7 升級至 Windows 8，則必須在電腦上安裝 Windows 8 的遠端伺服器管理工具；在您已升級至 Windows 8 的電腦上，已經沒有舊版的遠端伺服器管理工具。 </p>\n</blockquote>\n<p>下載後，雖然說感覺像是新功能，但官方這邊是把他歸類為更新。</p>\n<p><a href=\"http://lh6.ggpht.com/-s1O0lx4fEOQ/UR39DbCbqhI/AAAAAAAAF0M/2sZrT5ylrNQ/s1600-h/image8.png\"><img src=\"http://lh4.ggpht.com/-A3VA8dpKbOU/UR39EikkZfI/AAAAAAAAF0U/xZpMmQKJhd4/image_thumb4.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>安裝完成後，就可以看到系統管理工具和伺服器管理員已經安裝完成了。</p>\n<p><a href=\"http://lh4.ggpht.com/-yD9B75fIyXc/UR39FuHoHrI/AAAAAAAAF0c/nRaSQrC4H2w/s1600-h/image%25255B4%25255D.png\"><img src=\"http://lh6.ggpht.com/-mDWY5p7NpDI/UR39GcYPIeI/AAAAAAAAF0k/BFOyJ8IsAH8/image_thumb%25255B1%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>系統管理工具如下，都是依些Server的管理工具。</p>\n<p><a href=\"http://lh6.ggpht.com/-CfXzJIz2KKE/UR39HWfn5EI/AAAAAAAAF0s/2S0PTpLfVZs/s1600-h/image%25255B8%25255D.png\"><img src=\"http://lh5.ggpht.com/-sNAqRJvLECw/UR39IbQy_KI/AAAAAAAAF00/3K-wKMPPBe8/image_thumb%25255B3%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>而伺服器管理員，就如同Windows Server的管理員一樣，相信對於IT高手的前輩們，這就不太需要介紹了=V=。</p>\n<p><a href=\"http://lh3.ggpht.com/-x_VesF6p6wc/UR39JCOBAYI/AAAAAAAAF08/HmX7-gsB1v0/s1600-h/image%25255B13%25255D.png\"><img src=\"http://lh5.ggpht.com/-zXLq90XZtPg/UR39Jw78UsI/AAAAAAAAF1E/D_Xvi0wshzk/image_thumb%25255B6%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，我們要把藥管理的伺服器加入到伺服器管理員。</p>\n<p><a href=\"http://lh3.ggpht.com/-lJ5UXloOuFw/UR39KbOMZPI/AAAAAAAAF1M/unLlZlAR0pc/s1600-h/image%25255B17%25255D.png\"><img src=\"http://lh4.ggpht.com/-0MTJsuwOM-w/UR39LFpWKFI/AAAAAAAAF1U/pxuz19y6cUk/image_thumb%25255B8%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>如果有加入ad，那可以選擇第一個，但我們這邊還沒加入ad，所以選擇dns，然後我們可以搜尋框裡面填入主機名稱，或是ip位置，然後尋找到後，再把他加入到右邊。</p>\n<p><a href=\"http://lh4.ggpht.com/-zxXsJOmYPN0/UR39MHEWOSI/AAAAAAAAF1c/Wo6YKf7yNCA/s1600-h/image%25255B22%25255D.png\"><img src=\"http://lh3.ggpht.com/-HFuzOU9jYc4/UR39M3dujKI/AAAAAAAAF1k/wS27dtGkK-c/image_thumb%25255B11%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>加入完成後，馬上就會發生錯誤，錯誤訊息如下( 同下圖 ):</p>\n<blockquote>\n<p>vm - 設定重新整理失敗，且發生下列錯誤: 因為下列錯誤，無法從伺服器抓取中繼資料: WinRM 用戶端無法處理該要求。若驗證配置與 Kerberos 不同，或是用戶端電腦沒有加入網域， 則必須使用 HTTPS 傳輸，或是將目標電腦新增到TrustedHosts組態設定中，請使用winrm.cmd來設定TrustedHosts。請注意，可能不會驗證在TrustedHosts清單中的電腦。您可以執行下列命令，已取得相關的詳細資訊: winrm help config。 </p>\n</blockquote>\n<p>所以接下來，我們要設定winrm，這樣就可以順利管理了。</p>\n<p><a href=\"http://lh5.ggpht.com/-mfG5o3WqsDU/UR39NvCt1EI/AAAAAAAAF1s/UBLJPuG1-TE/s1600-h/image%25255B26%25255D.png\"><img src=\"http://lh4.ggpht.com/-gT3bkZ6adz8/UR39OvkQTGI/AAAAAAAAF10/ww-WhePsqsQ/image_thumb%25255B13%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>根據官網的附註，如下:</p>\n<blockquote>\n<p>如果您是從執行 Windows 7 的電腦管理遠端電腦，則啟動 Windows 遠端管理 (WinRM) 服務可以新增信任的主機。依序按一下 <strong>[開始]</strong>、<strong>[所有程式]</strong>、<strong>[附屬應用程式]</strong>，並在 <strong>[命令提示字元]</strong> 上按一下滑鼠右鍵，再按 <strong>[以系統管理員身分執行]</strong>，以較高的使用者權限開啟命令提示字元工作階段。輸入下列命令，然後按 <strong>Enter</strong>：<strong>net start winrm</strong> <p>對於工作群組對工作群組/網域狀況中的遠端連線，必須將遠端電腦新增到來源電腦上的信任主機清單中。若要這樣做，請以較高的使用者權限開啟 [命令提示字元] 視窗，在來源電腦上執行下列命令。  <p><strong>winrm set winrm/config/client @{TrustedHosts=\"RemoteComputerName\"}</strong> <p>對於工作群組對工作群組/網域狀況的遠端連線，若使用者不是使用來源電腦內建的系統管理員帳戶登入，則必須設定下列 <strong>WinRM</strong> 登錄機碼，才能從來源電腦進行遠端存取。由於對非 <strong>Administrators</strong> 群組成員的系統管理員帳戶有使用者帳戶控制 (UAC) 限制，因此必須進行此變更。若要變更此登錄機碼，請以較高的使用者權限開啟命令提示字元，在來源電腦上執行下列命令。  <p><strong>reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f</strong> <p><strong>WinRM</strong> 預設允許每位使用者對遠端電腦的連線數量上限為五個。若要提高上限，請以較高的使用者權限開啟命令提示字元，在來源電腦上執行下列命令，其中 X 代表您想要允許的連線數量。  <p><strong>winrm s winrm/config/winrs @{MaxShellsPerUser=\"X\"}</strong> </p>\n</blockquote>\n<p>所以我們要在win 8下，設定winrm，我們可以先輸入winrm get winrm/config/client看看目前的設定。( 別忘了cmd要使用administrator權限來做設定喔!! )</p>\n<p><a href=\"http://lh6.ggpht.com/-i6hJvr1_SYw/UR39PcPPTZI/AAAAAAAAF18/c8E9frv9iPs/s1600-h/image%25255B30%25255D.png\"><img src=\"http://lh3.ggpht.com/-XIoCW0AN2dA/UR39QEPdewI/AAAAAAAAF2E/x_SUybT_hwU/image_thumb%25255B15%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，我們輸入winrm set winrm/config/client @{TrustedHosts=”vm”}，其中vm的就是要管理的那台server名稱。</p>\n<p><a href=\"http://lh3.ggpht.com/-p6spSTiQy8k/UR39RFz9GUI/AAAAAAAAF2M/uuf76yjZrVo/s1600-h/image%25255B35%25255D.png\"><img src=\"http://lh5.ggpht.com/-Rv1othUzQog/UR39R_VwXGI/AAAAAAAAF2U/6dBFysvuBn0/image_thumb%25255B18%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>接下來，我們重新整理後，會發現，拒絕存取，那是因為，我們沒有遠端那台電腦的帳號與權限。</p>\n<p><a href=\"http://lh6.ggpht.com/-gQY8amdV2yc/UR39SiM6rTI/AAAAAAAAF2c/46Js6XYRY-Y/s1600-h/image%25255B39%25255D.png\"><img src=\"http://lh5.ggpht.com/-9U59ucT2CbI/UR39TjadzVI/AAAAAAAAF2k/_uAr5N1Ark4/image_thumb%25255B20%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>我們選擇管理身分。</p>\n<p><a href=\"http://lh4.ggpht.com/-TdkOFwAL7bM/UR39VG1yxMI/AAAAAAAAF2s/JzB6h6qt_6o/s1600-h/image%25255B43%25255D.png\"><img src=\"http://lh6.ggpht.com/-jXFKWvKbHaI/UR39WOrwJUI/AAAAAAAAF20/Axfk8-px13Q/image_thumb%25255B22%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這邊，就輸入遠端的帳號與密碼。</p>\n<p><a href=\"http://lh5.ggpht.com/-d41JObXdg2U/UR39WgSdO6I/AAAAAAAAF28/RfmC-jxrp3A/s1600-h/image%25255B47%25255D.png\"><img src=\"http://lh4.ggpht.com/-QlLoje1Il9w/UR39XW9ZgVI/AAAAAAAAF3E/JkJC_ZT1yMY/image_thumb%25255B24%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這時候，我們就可以看到，在win 8下，可以順利的進行管理了!!</p>\n<p><a href=\"http://lh3.ggpht.com/-xuDjR0o2z1s/UR39YPR5ZDI/AAAAAAAAF3M/TfKBSjXeKhc/s1600-h/image%25255B51%25255D.png\"><img src=\"http://lh4.ggpht.com/-Ccr4yqTi2mQ/UR39ZFfi5AI/AAAAAAAAF3U/9G3xHrqm6KQ/image_thumb%25255B26%25255D.png?imgmax=800\" alt=\"image\" title=\"image\"></a></p>\n<p>這樣就完成了!!</p>\n<h4>結論</h4>\n<p>透過伺服器管理員，我們就可以從win 8輕鬆的管理多台Server，也不用一台一台的遠端桌面過去看狀態，而這邊，比較麻煩的是因為沒加入ad，所以有比較多的步驟要處理，相信如果已經加入ad的電腦，會簡單許多；而這邊，小弟也簡單的獻曝，如果有錯，也請各位前輩多多指教。</p>\n<h4>參考資料</h4>\n<ul>\n<li><a href=\"http://technet.microsoft.com/zh-tw/library/hh921475.aspx\" title=\"http://technet.microsoft.com/zh-tw/library/hh921475.aspx\">http://technet.microsoft.com/zh-tw/library/hh921475.aspx</a></li>\n<li><a href=\"http://technet.microsoft.com/zh-tw/library/hh831456.aspx\" title=\"http://technet.microsoft.com/zh-tw/library/hh831456.aspx\">http://technet.microsoft.com/zh-tw/library/hh831456.aspx</a></li>\n<li><a href=\"http://technet.microsoft.com/zh-tw/library/dd759202.aspx\" title=\"http://technet.microsoft.com/zh-tw/library/dd759202.aspx\">http://technet.microsoft.com/zh-tw/library/dd759202.aspx</a></li>\n</ul>","excerpt":"年底這段時間，果然是最忙的，Blog也超久沒更新，雖然有滿多東西可以寫得，但也一直沒時間寫阿!!，而今天，剛好利用一點小時間，就順便寫一下關於IT的東西，不過我畢竟不是把IT當作主力的XDD，大家就隨意看看吧。 過年大掃除，順便把家裡的舊電腦，裝起Windows Server…"}},"pageContext":{"type":"posts","next":{"frontmatter":{"path":null,"title":"ASP.NET MVC -  Area出現指定的組件名稱或程式碼庫無效之問題","tags":["ASP.NET MVC"]},"fields":{"slug":"/2013/01/04/ASP-NET-MVC-Area出現指定的組件名稱或程式碼庫無效之問題/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/ASP-NET-MVC-Area出現指定的組件名稱或程式碼庫無效之問題.md"},"previous":{"frontmatter":{"path":null,"title":"Windows Server - 未啟動效能計數器","tags":["Windows Server"]},"fields":{"slug":"/2013/02/17/Windows-Server-未啟動效能計數器/"},"fileAbsolutePath":"/home/runner/work/blog.sanc.idv.tw/blog.sanc.idv.tw/src/posts/blog.sanc.idv.tw/Windows-Server-未啟動效能計數器.md"}}}}